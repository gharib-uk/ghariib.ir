<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Tracking Threat Actors Using Images and Artifacts</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Tracking Threat Actors Using Images and Artifacts</h1>
			<b><time>05.01.2025 00:00</time></b>
		       

			<div>
				<p>When tracking adversaries, we commonly focus on the malware they employ in the final stages of the kill chain and infrastructure, often overlooking samples used in the initial ones.</p>
<p>In this post, we will explore some ideas to track adversary activity leveraging images and artifacts mostly used during delivery. We presented this approach at the FIRST CTI in Berlin and at Botconf in Nice.</p>
<h1 id="hunting-early">Hunting early</h1>
<p>In threat hunting and detection engineering activities, analysts typically focus heavily on the latter stages of the kill chain – from execution to actions on objectives (Figure 1). This is mainly because there is more information available about adversaries in these phases, and it&rsquo;s easier to search for clues using endpoint detection and response (EDR), security information and event management (SIEM), and other solutions.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/s5LQJZB5dfNrmzJVUOMTUL6tdWKRGgQG48dd9HWc3TrAZ5bjOQlOwYH2o7vrmP4uk1vlKasqKLiF4g1YC8YA9EGypZc3THnFwst5HDE6dymOO3NPiYUw4kN4hgk_aO9D6fhl59p-TVFql254bfRy7nwzL9vu-vq7P9Xe36cmuXHK4wSVtO2lyz4wHCp5IA" alt="" />
</figure>


</p>
<p>Figure 1: Stages of the kill chain categorized by their emphasis on threat hunting and detection engineering.</p>
<p>We have been exploring ideas to improve our hunting focused on samples built in the weaponization phase and distributed in the delivery phase, focused on the detection of suspicious Microsoft Office documents (Word, Excel, and PowerPoint), PDF files, and emails.</p>
<p>In threat intelligence platforms and cybersecurity in general, green and red colors are commonly used to quickly indicate results and identify whether or not something is malicious. This is because they are perceived as representing good or bad, respectively.</p>
<p>Multiple studies in psychology have demonstrated how colors can influence our decision-making process. VirusTotal, through the third-party engines integrated into it, shows users when something is detected and therefore deemed &ldquo;malicious,&rdquo; and when something is not detected and considered &ldquo;benign.&rdquo;</p>
<p>For example, the sample in Figure 2 belongs to a Microsoft Word document distributed by the SideWinder group during the year 2024.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/7kWA4VniT6xkqNEm0GhIS5GxxVZK5nmis0MAEsGwcwBS7dI1_VmfGjnZAwGUx4s5rcFIuLDGeRrWhXJu6gd7DZdzAP0l5uoAskCL-TPzYwZL79KPLssSNsfR3YyszxnzduvgSdOdDBEQndIWJcZfNfO0IjMP5euW0JNzjpdMUp1Yrhz9aGnDrlU9C4dECg" alt="" />
</figure>


</p>
<p>Figure 2: Document used by the SideWinder APT group</p>
<p>The sample in question was identified at the time of writing this post by 31 antivirus engines, leaving no doubt that it is indeed a real malware sample. In the process of pivoting to identify new samples or related infrastructure, starting with Figure 2, the analyst will likely click on the URL detected by 11 out of the 91 engines, and the domains detected by 17 and 15 engines, respectively, to see if there are other samples communicating with them. The remaining two domains (related to windows.com and live.com) in this case are easily identified as legitimate domains that were likely contacted by the sandbox during its execution.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/KwmpkB3Cw8ssqE7HrvoLRilMM-wxDUFcmY0oW-dWfkF1moXeB82z_v0FF27pK7qyEtOfGLdyBqnXzGNFdJZLnFxUz2890pmiyRCThl5p2wB3_immk9PNOG9ktjEz56b9lTZs5VLUMvwoF61DXftK9_fcfCMmdThMSpJlRXk84CtjnveivoNoCdBuafI0EQ" alt="" />
</figure>


</p>
<p>Figure 3: Relationships within the SideWinder APT group document</p>
<p>In the same sample, if you go down in the VirusTotal report (Figure 3), the analyst will likely click on the ZIP file listed as &ldquo;compressed parent&rdquo; to check if there are other samples within this ZIP besides the current one. They may also click on the XML file detected by 8 engines, and the LNK file detected by 4 engines. The remaining files in the bundled files section probably won&rsquo;t be clicked, as the green color indicates they are not malicious, and also because they have less enticing formats — mainly XML and JPEG. But what if we explore them?</p>
<h1 id="xml-files-generated-by-microsoft-office">XML files generated by Microsoft Office</h1>
<p>When you create a new Microsoft Office file, it automatically generates a series of embedded XML files containing information about the document. Additionally, if you use images in the document, they are also embedded within it. Microsoft Office files are compressed files (similar to ZIP files). In VirusTotal, when a Microsoft Word file is uploaded, you can see all these embedded files in the embedded files section.</p>
<p>We have mainly focused on three types of embedded files within Office documents:</p>
<ul>
<li>
<p>**Images:**Many threat actors use images related to the organizations or entities they intend to impersonate. They do this to make documents appear legitimate and gain the trust of their victims.</p>
</li>
<li>
<p>**[Content_Types].xml:**This file specifies the content types and relationships within the Office Open XML (OOXML) document. It essentially defines the types of content and how they are organized within the file structure.</p>
</li>
<li>
<p>**Styles.xml:**Stores stylistic definitions for your document. These styles provide consistent formatting instructions for fonts, paragraph spacing, colors, numbering, lists, and much more.</p>
</li>
</ul>
<p>Our hypothesis is: If malicious Microsoft Word documents are copied and pasted during the weaponization building process, with only the content being modified, the hashes of the [Content_Types].xml and styles.xml files will likely remain the same.</p>
<h1 id="office-documents">Office documents</h1>
<p>To check our hypothesis, we selected a set of samples used during delivery and belonging the threat actors listed in Figure 4:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/6kd1dSM2J_nvzXZA4svGFwd8MqggvB30sY9NiBDFQwzuRXa8GBN0Ui5jR8gfMxeGztTLTg5qFkvj7CPws0gQlmDydHUhn1JJp9Ftf8N46QDoIvoE3DT5RCH3gK-Hz745O0y2vnyEcDH149bXNr6uMHAQCo1cmUdOQffMScxZCmKFck9HlVMqybWKI9O5zA" alt="" />
</figure>


</p>
<p>Figure 4: Number of samples per actor within the scope</p>
<p>Let’s analyze some of the results we obtained per actor.</p>
<h2 id="apt28--images">APT28 – Images</h2>
<p>We started by focusing on images APT28 has reused for different delivery samples (Figure 5).</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CnCsPL8T-i36ADUB_SVjZx9v-qOQELIyMc4b_3T80h8RJPuk3b_FkPujEVRXD1g9HufveUK9QmlqFHOfCl1nIGaNLYQITYrFPZTP3-00Pi9tp6XZpSFTVCau1SgXPzUkjJiIXhk-y1Ax3l_huKsTYdabMD5lRwIDoN3MFo6JqxSDQTvKdx9jTdPBW4FH2A" alt="" />
</figure>


</p>
<p>Figure 5: Images shared in multiple documents by APT28</p>
<p>Each line in the Figure 5 graph represents the same image, and each point represents at least two samples that used that particular image.</p>
<p>The second image of the graph shows how it was used by different Office documents at different points in time, from 2018 to 2022 (dates related to their upload to VirusTotal).</p>
<p>Now, the chart in Figure 6 visualizes each of these images.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/IQ_5NDy3c6PFNw5zr4ekwEANoWYWE_PNnqyx1IbDPzk17vI_hx9NGwBGVC75RQDX3GFpf8SU70mm8yxSmohGNTxv7xQZNrccyMhgwQZlVxfDFfvOWEMl_OAEaY81U8GysGTRXNhw3YNTkixJpPks0Zb5etunSQZalbxdxZdsBuCmMRzkD9sLLLPfXGfEqg" alt="" />
</figure>


</p>
<p>Figure 6: Content of the images shared in multiple documents by APT28</p>
<ul>
<li>
<p>The first image is just a simple line with no particular meaning. It&rsquo;s embedded in over 100 files known by VirusTotal.</p>
</li>
<li>
<p>The second image is a hand and has 14 compressed parents.</p>
</li>
<li>
<p>The third image consists of black circles and also has over 100 compressed parents.</p>
</li>
<li>
<p>The last image is like a Word page with a table, presenting a fake EDA Roadmap of the European Commission. The image format is EMF (an old format) and it has 4 compressed parents</p>
</li>
</ul>
<p>If we delve into the compressed parents of the second image (the one with the hand), we can see how the image is used in Office documents that are part of a campaign reported by Mandiant attributed to APT28. The image of the hand was used in fake Word documents for hotel reservations, particularly in a small section where the client was supposed to sign.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/DcfFdBpuJACB3xyoYf2Vju9h33MJZcmjjJz7zPmZyuFJvKpbnqD3ObYIcHwjJtoPVjbfuGWziN0EElW0_2f-IzXYRqK7i8lBamguXLTHHU-l2BqbkK6niYELIBsERXINY55yQEdPA-_aqbUsmPoPkmyYBidqVfr0DEmfYXtulEUVOgpS2yWTXHnglF8R8A" alt="" />
</figure>


</p>
<p>Figure 7: Pivoting through a specific image used by APT28</p>
<h2 id="sidewinder--images">SideWinder – Images</h2>
<p>SideWinder (aka RAZER TIGER) is a group focused on carrying out operations against military targets in Pakistan. This group traditionally reused images, which might help monitoring their activity.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CRkqUEk-iZIvbiR1w1oJ7hRyRRjgD0PyExRL98MpTHWbW2eWhpSsYLxObreZyrqCpsX0Z5fwb1Jq8Uc41ljdIaoqqjKAQs40OFaM53bzNQwmi3KqHtStkPqQFQYlG8Jf3ZQ1lobBbc2tcz6YdiAp83b8GyRioPV4kq821mD1Bv7X9i3w8cMKqpQ5WYx8Kw" alt="" />
</figure>


</p>
<p>Figure 8: Images shared in multiple documents by RAZOR TIGER</p>
<p>In particular, the image in Figure 9 was used in a sample uploaded in September 2021 and in a second one uploaded March 2022. The image in question is the signature of Baber Bilal Haider.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/eZSDnI-aoZj4s9ScYTKBsixIUvsonqoaNjlh6r_CLYrIGkC6xkLhrDHlup2PcKt8def5SuBdfE3EAsH2iDTWgPNQ-WKPI2ej8KM75Ycor70o7i7QIee_IRfVn6OIbDtS8DhabcXoyL_RCCYagO99yoUJ8BgaVGRVVwaLEGQg8RhsT0yi10zYe_-awDfyBQ" alt="" />
</figure>


</p>
<p>Figure 9: Two different samples of RAZOR TIGER share the same image of a handwritten signature</p>
<h2 id="gamaredon--content_typesxml-and-stylesxml">Gamaredon – [Content_Types].xml and styles.xml</h2>
<p>For Gamaredon we found they reused styles.xml and [Content_Types].xml in different documents, which helped reveal new samples.</p>
<p>Figure 10 chart displays all the [Content_Types].xml files from Gamaredon&rsquo;s Office documents.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/walAH7apLtyJytKdM3s-zNTaGL0QuAP8q4Y2YN-uQCC1K0zTfhMlPRScq0WvgsQoAqULYUA5_kIgZi8sG9sxrks2i8rkM9IIq-Sf_5TIP_bPBRb3_MTXZVuucpGAoM6QEu1BD5soXk5Yd7pTvT80SbhM52AFILAEDTjNs4qJWyDVAfijGOM297m18dNwsg" alt="" />
</figure>


</p>
<p>Figure 10: [Content_Types].xml shared in multiple documents by Gamaredon Group</p>
<p>There are a large number of samples that share the same [Content_Types].xml. It&rsquo;s important to highlight that these [Content_Types].xml files are not necessarily exclusively used by Gamaredon, and can be found in other legitimate files created by users worldwide. However, some of these [Content_Types].xml might be interesting to monitor.</p>
<p>Styles.xml files are usually less generic, which should make them a better candidate to monitor:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/Y5sasbBbb4dyH-Ocs-rpceryW4CSZNpeVc0ess9zmj_vT_5oxD-uvy3Zh-o8HMbjN7hxeSahpEnywIWgx66Ojd_0HdyECac_xpICX1u4NeXldPjPuUhuK-nhRrpBejFmiKUkdA0SQZuEYusIp_KP0L65saJ0l3F9_LGArqsJ8ucWt3kxzgp5Uzv9Kw0Q9g" alt="" />
</figure>


</p>
<p>Figure 11: Styles.xml shared in multiple documents by Gamaredon Group</p>
<p>We see styles.xml files are less reused than [Content_Types].xml. This could be because some of the samples used by this actor for distribution are created from scratch or reusing legitimate documents.</p>
<p>We used identified patterns in the styles.xml files to launch a retrohunt on VirusTotal. Figure 12 visually represents the original set of style.xml files (left) and those that were added later after running the retrohunt (right).</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/DARhJBD7pfoI_SmFWF8GvauyeGlQ63MpeAzBfYSMzYpSVTNixDTfp0q5B5OBqSXAVtdDeNkjjEI0yf4dZId0Wx-AvzkrwvlMpINo6iG9oCdojGQyC5NhdJJ2xH21AJ03kPkAXuxa9c6xRW6C1kt5Tve9AnYPcVlantydToAB4OIloZtGjTp9oMZ-5GodoQ" alt="" />
</figure>


</p>
<p>Figure 12: Initial graph of the styles.xml and its parents used by Gamaredon (left). Final graph after identifying new styles.xml and their parents using retrohunt in VirusTotal (right)</p>
<p>One of the new styles.xml files found in our retrohunt has 17 compressed parents, meaning it was included in 17 Office files.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/KbSxemTzMcRX7c1ozDFdc45MA1LKrt1hvd_Y-0ruyJJn78ovDvYO-fkXj0PVcHWDjVhc7X4sYOOuRabHnFPSTCDaeY3H9usIrgh6d9y9cdMEWscpI4DmOYF-kwpFEez3KbmKhaRXfa0o3AxLpsK6kTOBaIf1TlKDlGn83ocZMMLOvhtAhxrDQ5weVgOEwg" alt="" />
</figure>


</p>
<p>Figure 13: Number of parent documents for a specific styles.xml file used by Gamaredon</p>
<p>All the parents were malicious, some of them identical and the rest very similar between them. The content of many of them referred to &ldquo;Foreign institutions of Ukraine - Embassy of Ukraine in Hungary,&rdquo; containing a table with phone numbers and information about the embassy, such as social media links and email accounts. Here&rsquo;s an example:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/SOQpaMCcBAQ_Qeuoa9o0V2WiwAFD2i64pJo3Z1WhhpGoTTkKWclGtHfHLvbYizn0fwdCkXJizS1XtxN47Dv4qdbQ3bqcln38e3lTBYIDJgAJ6OJ1VGlkW0ibsMmg_XBaYpIQBoCnd5wls36KFgEMdRi-vHl4Af8dhKlTitAApuVtlqdb03oj2aGFUmDUyQ" alt="" />
</figure>


</p>
<p>Figure 14: Document used by Gamaredon in one of its campaigns that includes multiple images which can be used to monitor new samples</p>
<p>The information for social media includes the logos of these platforms, such as the Facebook logo, Skype logo, an image of a telephone, etc. By pivoting, on the image of the Facebook icon, we find that it has 12 additional compressed parents, meaning it appears in 12 documents, all of them sharing the same styles.xml file.</p>
<p>Visualizing all together, we find a set of about 12-14 images used within the same timeframe by the actor. All of these images can be found in the “Embassy of Ukraine in Hungary” document.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QMEcz0BFywlmsUEaE2M-nECs8rkGmopeamCWMv2kwCgHiTKfDhP3ptEcv1PxXPkcsy3KZV47co9T5gOUQF3rcAhH1OSMQCKK3YQTaFi3WfFAoFSx0eX34rsZG2Cy1UV8OgC74AEk__IX7G_NBwu0P9hf9Hu1OqJ-6lcNRjDo4XZEw8HRr-hHoW8_tuGQvA" alt="" />
</figure>


</p>
<p>Figure 15: Pivoting through the Facebook image that included the document in Figure 14</p>
<p>There&rsquo;s a pattern evident in the previous image where different images were included in files uploaded simultaneously. This pattern is associated with multiple documents used in the same campaign of the Embassy of Ukraine in Hungary, all of them were using the same social media images explained before.</p>
<h2 id="stylesxml-shared-between-threat-actors">Styles.xml shared between threat actors</h2>
<p>Another aspect we explored was if different threat actors shared similar styles.xml files in their documents. Styles.xml files are somewhat more specific and unique than [Content_Types].xml files because they can contain styles created by threat actors or by legitimate entities that originally created the document and then were modified by the actor. This makes them stand out more and can help in identifying threat actor activity.</p>
<p>This doesn&rsquo;t necessarily imply they share information to conduct separate operations, although in some cases, it could be a scenario worth considering.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QwJMAXmM58Me8QYbW4DKjXip6nB3MPC6B7fXpGn0F_6_ElYhx2nPPmkgl3Pas41WwAo6BS4hUpb8LAH_2awI7YEA9hZGmBVGaRDvEbrs4ToFy66I2BKUnJjUGmJ_gIyDLQthxljbPW1U7qYnWs4VrzR2_ulDfZh2uNLYqT9nT3zNjYY7UWHozlMhwZS70Q" alt="" />
</figure>


</p>
<p>Figure 16: styles.xml shared between different threat actors</p>
<p>Of all styles.xml files related to actors in our initial set, only six of them were found to be shared by at least two actors. Some styles defined by the styles.xml file are very generic and could identify almost any type of file. However, there are others that could be interesting to explore further.</p>
<p>An interesting case is the Styles.xml file, which seems to be shared by Razor Tiger, APT28, and UAC-0099. Specifically, the samples from APT28 and UAC-0099 are attract because they were uploaded to VirusTotal within short time frames, suggesting they might belong to the same threat actor.</p>
<p>The file 243bab79863327915c315c188c0589202f64b3500a3fee3e2c9f3d34e8e1f154 attributed to APT28, the file 2c2fa6b9fbb6aa270ba0f49ebb361ebf7d36258e1bdfd825bc2faeb738c487ed attributed to UAC-0099, and the file 61a5b971a6b5f9c2b5e9a860c996569da30369ac67108d4b8a71f58311a6e1f1 attributed to UAC-0099 all share the same styles.xml and [Content_Types].xml.</p>
<p>You can see the list of hashes in the appendix of this blog</p>
<h2 id="content_typesxml-shared-between-threat-actors">[Content_Types].xml shared between threat actors</h2>
<p>Like in the previous case, we checked if there were Office documents among different threat actors sharing [Content_Types].xml:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/ksdSRbv4YJXoGDU0rDCl5Hg2GmMUtgf-eR7KKIBuRDNAOO9oSLPQGoMlaJmVOH2ji3yBdPJAjVAYxCy0Qm9NjNU2xjiPd7qI8eaVgCd6V0fzF6xSr6jbdWfqtTD7rdpHL34MRQ3HTgx126KV3CwbpFFLn0yW_AxzltGbMRRQidBw7oQuvoh6g5AEZvjaow" alt="" />
</figure>


</p>
<p>Figure 17: [Content_Types].xml shared between different threat actors</p>
<p>In this case, there are eleven [Content_Types].xml files that are shared by at least two different actors.</p>
<p>An interesting case here is the file dfa90f373b8fd8147ee3e4bfe1ee059e536cc1b068f7ec140c3fc0e6554f331a, which is shared by Gamaredon, APT37, Mustang Panda, APT28, SideCopy, and UAC-0099. Again, there could be different explanations for this.</p>
<p>Another interesting case that is worth analyzing in detail is [Content_Types].xml with hash 4ea40d34cfcaf69aa35b405c575c7b87e35c72246f04d2d0c5f381bc50fc8b3d, which is only shared by APT28 and APT29.</p>
<p>You can see the list of hashes in the appendix of this blog</p>
<h2 id="ai-to-the-rescue">AI to the rescue</h2>
<p>The images reused by attackers seem to be a promising idea we decided to further explore.</p>
<p>We used the VirusTotal API to download and unzip a set of Office documents used for delivery, this way we obtained all the images. Then we used Gemini to automatically describe what these images were about.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/_8hurXC6ksmGULpXVi9oq81CvGl52yrJujoc8bUdJtQtEyXQ1njcZvgcVAnF_HVezOEZWRDFEngIZ0ofnyXVQy4VMbMXau7Oc-MRBVVnQcO8AegE2oi8MpJFaQQjwSZclXZ4EV24FOFQ9mDIBh5yW6WUgHC_jATMUbVvADdsvry23XF0nCvy3Hjyp9FPhA" alt="" />
</figure>


</p>
<p>Figure 18: Results obtained with Gemini after processing some of the embedded images in the documents used by the threat actors</p>
<p>Figure 18 shows some examples of images that were incorporated by certain actors. There were also other results that were not helpful, mainly related to images that did not show a logo or anything specific that indicated what they were.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/ZfJH60IC-q_i6MPSyzKv8CqPvqYmOxmTboE8L_IY9DruJLoI4PBJO5IR5lzBYrA76aFzXp_kWSgQVTsI_pg5xjviAqIu5JbBdFqzBUQPaTLEd0n3BL2nIg2XJQTg8aFrf8xC8pc8qBSfEPTSt63ID9pJaq373EghKQSPuBUw6ZQriZZBqUjkLKvvIKR_jA" alt="" />
</figure>


</p>
<p>Figure 19: Results obtained with Gemini after processing some of the embedded images in the documents used by the threat actors</p>
<p>Using the VirusTotal API to obtain documents that you might be looking for and combining the results with Gemini to analyze possible images automatically, can potentially help analysts to monitor potential suspicious documents and create your own database of samples using specific images, for example Government images or specific images about companies. This approach is interesting not only for threat hunting but also for brand monitoring.</p>
<h1 id="pdf-documents">PDF Documents</h1>
<h2 id="images-dropped-by-acrobat-reader">Images dropped by Acrobat Reader</h2>
<p>Unlike Office documents, PDF files don&rsquo;t contain embedded XML files or images, although some PDF files may be created from Office documents. Some of our sandboxes include Adobe Acrobat Reader to open PDF documents which generates a thumbnail of the first page in BMP format. This image is stored in the directory C:UsersAppDataLocalLowAdobeAcrobatDCConnectorIcons. Consequently, our sandboxes provide this BMP image as a dropped file from the PDF, allowing us to pivot.</p>
<p>To illustrate this functionality, see Figure 20 attributed to Blind Eagle, a cybercrime actor associated with Latin America.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/J_4FZ3bEMoo8FCIDgM6PG4D1v_E00bUxPA1xzobzoZUFW-f8zSco0hgFIv1x29lyqzXlHlPlrbvGJ8A7rryI4sCdUB_wXwMsIJfuNYblcYocYkSFSPlYldBja1PuB-jaXtR1wF3vtL-Og6h54yVd4u9qIT9T4KD08JlXs2N-hj3fer42WLftN0QYSSWMow" alt="" />
</figure>


</p>
<p>Figure 20: Content of a PDF file related to Blind Eagle threat actor</p>
<p>Figure 20 was provided by our sandbox. In the &ldquo;relations&rdquo; tab, we can see the BMP image as a dropped file:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/xw6hpEpeV_jeNm11GqtR2XWP2jnIr_rcfxbBjgKXZuuCAGNnGxiSC4qLA5IHVq983ebawLx2ubJh_um9r_bUM8aodJRCeoz8AAyO_cmRuZAgKhSSKf6Tfur4dyUg1z7neU9cUtFqKCYkJS5mRKoC8F-h7DH-AtuNW-oSHl9PyEUaQimWOi9ua8HBwSpM6Q" alt="" />
</figure>


</p>
<p>Figure 21: BMP file generated by the sandbox that can be used for pivoting</p>
<p>The BMP file itself also shows relations, in particular up to 6 PDF files in the &ldquo;execution parents&rdquo; section. In other words, there are other PDFs that look exactly the same as the initial one.</p>
<p>Typically, many actors engaged in financial crime activities utilize widely spread PDF files to deceive their victims, making this approach highly valuable. Another interesting example we found involves phishing activities targeting a Russian bank called &ldquo;Tinkoff Bank.&rdquo;</p>
<p>The PDF files urge victims to accept an invitation from this bank to participate in a project.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/FbOD9YwQ3eQrENHYsSBPqjWAcJ7LGNn1eKUxlU3XLlq0zUBUbBJl5_8CynQ1Iu0s-6b16R00xNFVLFLwuNphD-vu9W22SCZYBD2fXtlyp-28bE6eNfVk-jrr3ImZnESVo-5E0V7-9NGD4Gp6R6wMz6rInszLpYHEVURZoRNARovoUY1XAQyTkQ2cLVkkaA" alt="" />
</figure>


</p>
<p>Figure 22: The content of a PDF file used by cybercrime actors</p>
<p>Applying the same approach we identified 20 files with identical content, most of them classified as malicious by AV engines.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/STde7dFiRTZqtPJRNzdKFEtxhTUJ_FwQa0TPob1HgsanQ2EqXQYfCFtZFgDzkZGP4v7jjIyXhoOvTC0cwLpqZC3W0cbyBxxx9kocOXyWtv77sfjR10iSwKt_iQsLtsovDnoV_cjZLqYDUvjRqMDjTY5anJCiv5mH1lT6G7NR-KlOJeAV5Uek6ugyLAkE7A" alt="" />
</figure>


</p>
<p>Figure 23: BMP file generated by the sandbox that can be used for pivoting, in this case having other 20 PDF with the same image</p>
<p>There are some limitations to this approach. For instance, the PDF file might be slightly modified (font size, some letter/word, color, …) which would generate a completely different hash value for the thumbnail we use to pivot.</p>
<h2 id="images-dropped-by-acrobat-reader-1">Images dropped by Acrobat Reader</h2>
<p>Just like the BMP files generated by Acrobat Reader, there are other interesting files that might be dropped during sandbox detonation. These artifacts can be useful on some occasions.</p>
<p>The first example is a JavaScript file dropped in another PDF attributed to Blind Eagle.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/c-JSnxdyx_FVOts2J9ivRMqqOFw-aJ8MyG_PN0HAx3BapmCoPSPV213P-ZpxTuxAhCiAdm750nvEafxc1F670C3UJQbfTAM52k394PDwmxmnPCkoYGmfQPboj9914_YVNIbuj9ZCp97pnWWkSH4TVRCFx82pU9Ucedz98OqO3IhT-evMBIhJw7mm63uSMw" alt="" />
</figure>


</p>
<p>Figure 24: BMP file generated by the sandbox that can be used for pivoting, another example of Blind Eagle threat actor</p>
<p>The dropped JavaScript file&rsquo;s name during the PDF execution was &ldquo;Chrome Cache Entry: 566&rdquo; indicating that this file was likely generated by opening an URL through Chrome, possibly triggered by a sandbox click on a link within the PDF. Examining the file&rsquo;s contents, we observe some strings and variables in Spanish.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/cpJvuC9oIbAcHXHn5vm8Kc8KAjkB2Bq1AeaV7hs29lRB0PxDtRypcoOnd8AIZZ8eqyvJMfVenLVb1oHgTDTHrLdPB6KzBz8vkAOcCqaxgVPIZaGB0miGvkkT4EfeW8qISX7vyFod5DqvSlrLe1bPJsCdfr5yqkue2a4XdYuBee-m2836f0xMY3dx86imWA" alt="" />
</figure>


</p>
<p>Figure 25: Artifact generated by the sandbox via Google Chrome when connecting to a domain</p>
<p>The strings “registerResourceDictionary”, “sampleCustomStringId”, “rf_RefinementTitle_ManagedPropertyName” are related to Microsoft SharePoint as we were able to confirm. These files were probably generated after visiting sites that have Microsoft Sharepoint functionalities. We found that all the PDFs containing this artifact dropped by Google Chrome came from a website belonging to the Government of Colombia.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QYgpWOVmWs9i8td1Gk4VrxhYdrlixNvCYRgJA0daeFQfWKWfDcmsTGgjuhhZI32JqG92EFSvp-kCxwea4Raza0FCP5TaZdTERPZ6w1Ua7S17D_6e0UVhbSwheHcdXP_Gpfbz-ifkpnZT_9mWhfGuGd-56Fvyg0LBNNcoPx_-HBFquXCH1VkmH6hkWEy2CQ" alt="" />
</figure>


</p>
<p>Figure 26: Flow of artifact generation related to Google Chrome that can be used for pivoting in VirusTotal</p>
<h2 id="email-files">Email files</h2>
<p>Many threat actors incorporate images in their emails, such as company logos, to deceive victims. We used this to identify several mailing campaigns where the same footer was used.</p>
<h2 id="campaign-impersonating-universities">Campaign impersonating universities</h2>
<p>On November 13, 2023, we details about a new campaign impersonating universities, primarily located in Latin America. By leveraging the presence of social network logos in the footer, we were able to find more universities in different continents targeted by the same attacker.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/M7hfVLeq3Bc1GHZfzZaJKG8rzUs5a3dfCl_RU1WlQzRi8DWPX8W_kVIX225YzYMYzUJLPM3GjXDkUD7MNCluw-_hcpb0mYjiKRen2pSJP_4VTzi-HweQ6WET8gOoY2mW0_6_vjzZYoZ7aa6JkxoiCkdV6eQ7aBc3CAKL9zodwBLtmi7N_oxNiSTGPKKssQ" alt="" />
</figure>


</p>
<p>Figure 27: Email impersonating a university that contains multiple images</p>
<p>Figure 27 shows several images, including the University of Chile&rsquo;s logo and building, as well as images related to social networks like YouTube, Facebook, and Twitter.</p>
<p>Pivoting through the images related to the University of Chile doesn&rsquo;t yield good results, as it&rsquo;s too specific. However, if we pivot through the images of the social media footer, represented as email attachments, we can observe multiple files using the same logo.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/l1r2N-4zSX67dxKRm3vA_ze9ejQChIBPmEC9pce7oLE0_QgoCvcCa81csh1o8_obypmRvrCdMDIO55Zcvy3f26fUWLvImwf918LGagevTq4Hk1nhzfOYQLiy0PWz5zvQdIMYeaxP3jSWsCz7k9DCGKqDNl-ucytZZNinR-LJouBKgIaKKKeJexa5VRE9NA" alt="" />
</figure>


</p>
<p>Figure 28: Using the images from the email footer to pivot and identify new emails</p>
<p>Just by analyzing one of the social media logos, we saw 33 email parents, all of them related to the same campaign.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/aauno6BU2EVPf_CXBXN4h2B08BXkCLO7dQSGhg5vGKNW8CcGJVzgBYP5QJmv7tafZV6gvw-30paF2Kex4MecOcQP4Se3_73csJs0KScbhTurkqD7OGKmxEoE4CdvXSfhUVpWRf3yd4a27F4U722KRXYRPM9szOVm_42HiFMhc-RB9exU79vixpf9MlT7KA" alt="" />
</figure>


</p>
<p>Figure 29: Other emails identified through image pivoting techniques</p>
<h2 id="campaigns-impersonating-companies">Campaigns impersonating companies</h2>
<p>Another usual case is adding a company logo in the email signatures to enhance credibility. Delivery companies, banks, and suppliers are some of the most observed images during our research.</p>
<p>For example, this email utilizes the corporate image of China Anhui Technology Import and Export Co Ltd in the footer.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/LlZOzxiYkXjWdiLSleQ79w_RVJyKaRqh1M7ne310yqtid97wiW8YZd8M27vm148hqEIY20ZvoCuuh3x9bT6t5aJbKbqwO9kPnU7f4xNPXtA4pHDfcR0zGiVmxGgAUL6ebj8So0dgvjxey8ko99TUXmfOn3pm6oIm07WnnudbxAbOVYBt5nInlbVSYydCcA" alt="" />
</figure>


</p>
<p>Figure 30: Email impersonating a Chinese organization using the company logo in the footer</p>
<p>Pivoting through the image we found 20 emails using the same logo.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/_gIXDeILPZ3P72ekVHi-5_85zHLr-YaxrsmJ7gLgBqsNn1Vwa4bm7vQNF1T7g_Df5RsTwzR4ETCfhfrjI8VA5Yg2IMopiUXuR4RV7c5dSH9eB66MbYuxbFZn3SDHptL91tEbLchhVHVDanBqJy50DPjmj3xmuLm_E8yMnLYoKMqpcHKj7ic-VQWf8kmuHg" alt="" />
</figure>


</p>
<p>Figure 31: Other emails identified through image pivoting techniques</p>
<h1 id="wrapping-up">Wrapping up</h1>
<p>We can potentially trace malicious actors by examining artifacts linked to the initial spreading documents, and in the case of images, AI can help us automate potential victim identification and other hunting aspects.</p>
<p>In order to make this even easier, we are planning to incorporate a new bundled_files field into the IOCs JSON structure, which basically will help to create livehunt rules. In the meantime you can use vt_behaviour_files_dropped.sha256 for those scenarios where the files are dropped.</p>
<p>In certain situations, the styles.xml and [Content_Types].xml files within office documents can provide valuable clues for identifying and tracking the same threat actor. The method presented here offers an alternative to traditional hunting or pivoting techniques, serving as a valuable addition to a team&rsquo;s hunting activities.</p>
<p>We hope you found this research interesting and useful, and as always we are happy to hear your feedback.</p>
<p>Happy hunting!</p>
<h1 id="appendix">APPENDIX</h1>
<h3 id="content_typesxml-shared-between-threat-actors-1">[Content_types].xml shared between threat actors</h3>
<table>
  <thead>
      <tr>
          <th>[Content_Type].xml sha256</th>
          <th>Shared by</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>3d8578fd41d766740a1f1ddef972a081436a2d70ab1e9552a861e58d8bbf5321</td>
          <td>APT33, APT32</td>
      </tr>
      <tr>
          <td>4ea40d34cfcaf69aa35b405c575c7b87e35c72246f04d2d0c5f381bc50fc8b3d</td>
          <td>APT29, APT28</td>
      </tr>
      <tr>
          <td>4f7fa7433484b4e655d185719613e2f98d017590146d15eedc1aa1d967636b3a</td>
          <td>FIN7, Gamaredon, APT28, APT32</td>
      </tr>
      <tr>
          <td>529739886f6402a9cd5a8064ece73eef19c597ef35c0bc8d09390e8b4de9041b</td>
          <td>FIN7, APT33, TA505, Mustang Panda</td>
      </tr>
      <tr>
          <td>688dca40507fb96630f3df80442266a0354e7c24b7df86be3ea57069b25d12c6</td>
          <td>Gamaredon, APT33</td>
      </tr>
      <tr>
          <td>6f1ac5f0ebfb7e97d3dc4100e88eaab10016a5cac75e1251781f2ea12477af51</td>
          <td>Gamaredon, Hazy Tiger, APT33,</td>
      </tr>
      <tr>
          <td>7796c382cd4c7c4ae3bcf2eed4091fbb20a2563ca88f2aecadb950ad9cf661f8</td>
          <td>Razor Tiger, APT28, UAC-0099</td>
      </tr>
      <tr>
          <td>b4fa7f3faa0510e4d969219bceec2a90e8a48ff28e060db3cdd37ce935c3779c</td>
          <td>Razor Tiger, SideCopy</td>
      </tr>
      <tr>
          <td>dfa90f373b8fd8147ee3e4bfe1ee059e536cc1b068f7ec140c3fc0e6554f331a</td>
          <td>Gamaredon, APT37, Mustang Panda, APT28, UAC-0099, SideCopy</td>
      </tr>
      <tr>
          <td>fe98b3bcf96f9c396eb9193f0f9484ef01d3017257300cc76098854b1f103b69</td>
          <td>FIN7, Hazy Tiger</td>
      </tr>
      <tr>
          <td>ff5a5ba3730a8d2ec0cbad39e5edf4ad502107bd0ef8a5347f29262b3dfe8a43</td>
          <td>Mustang Panda, APT32</td>
      </tr>
  </tbody>
</table>
<h3 id="stylesxml-shared-between-threat-actors-1">styles.xml shared between threat actors</h3>
<table>
  <thead>
      <tr>
          <th>Styles.xml sha256</th>
          <th>Shared by</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>13ed55637980452662cb6838a2931a5e54fbed5881bcbae368b3d189d3a01930</td>
          <td>APT28, UAC-0099, Razor Tiger</td>
      </tr>
      <tr>
          <td>2de1fc9c48c4b0190361c49cdb053fd39cf81e32f12c82d08f88aec34358257f</td>
          <td>Hazy Tiger, Gamaredon, APT33</td>
      </tr>
      <tr>
          <td>59df7787c7cf5408481ae149660858d3af765a0c2cd63d6309b151380f92adb2</td>
          <td>TA505, Gamaredon</td>
      </tr>
      <tr>
          <td>8f590f608f0719404a1731bb70a6ce2db420fd61e5a387d5b3091d47c7e21ac9</td>
          <td>APT28, FIN7, Razor Tiger, APT32, APT33</td>
      </tr>
      <tr>
          <td>de392cd4bf1d650a9cf8c6d24e05e0605bf4eaf1518710f0307d8aceb9e5496c</td>
          <td>Hazy Tiger, FIN7</td>
      </tr>
      <tr>
          <td>e16f84c5fd1df6af1a1f2049f7862f4ea460765863476afb17e78edee772d35b</td>
          <td>APT32, SideCopy, Mustang Panda, Razor Tiger</td>
      </tr>
  </tbody>
</table>
<p>When tracking adversaries, we commonly focus on the malware they employ in the final stages of the kill chain and infrastructure, often overlooking samples used in the initial ones.</p>
<p>In this post, we will explore some ideas to track adversary activity leveraging images and artifacts mostly used during delivery. We presented this approach at the FIRST CTI in Berlin and at Botconf in Nice.</p>
<h1 id="hunting-early-1">Hunting early</h1>
<p>In threat hunting and detection engineering activities, analysts typically focus heavily on the latter stages of the kill chain – from execution to actions on objectives (Figure 1). This is mainly because there is more information available about adversaries in these phases, and it&rsquo;s easier to search for clues using endpoint detection and response (EDR), security information and event management (SIEM), and other solutions.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/s5LQJZB5dfNrmzJVUOMTUL6tdWKRGgQG48dd9HWc3TrAZ5bjOQlOwYH2o7vrmP4uk1vlKasqKLiF4g1YC8YA9EGypZc3THnFwst5HDE6dymOO3NPiYUw4kN4hgk_aO9D6fhl59p-TVFql254bfRy7nwzL9vu-vq7P9Xe36cmuXHK4wSVtO2lyz4wHCp5IA" alt="" />
</figure>


</p>
<p>Figure 1: Stages of the kill chain categorized by their emphasis on threat hunting and detection engineering.</p>
<p>We have been exploring ideas to improve our hunting focused on samples built in the weaponization phase and distributed in the delivery phase, focused on the detection of suspicious Microsoft Office documents (Word, Excel, and PowerPoint), PDF files, and emails.</p>
<p>In threat intelligence platforms and cybersecurity in general, green and red colors are commonly used to quickly indicate results and identify whether or not something is malicious. This is because they are perceived as representing good or bad, respectively.</p>
<p>Multiple studies in psychology have demonstrated how colors can influence our decision-making process. VirusTotal, through the third-party engines integrated into it, shows users when something is detected and therefore deemed &ldquo;malicious,&rdquo; and when something is not detected and considered &ldquo;benign.&rdquo;</p>
<p>For example, the sample in Figure 2 belongs to a Microsoft Word document distributed by the SideWinder group during the year 2024.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/7kWA4VniT6xkqNEm0GhIS5GxxVZK5nmis0MAEsGwcwBS7dI1_VmfGjnZAwGUx4s5rcFIuLDGeRrWhXJu6gd7DZdzAP0l5uoAskCL-TPzYwZL79KPLssSNsfR3YyszxnzduvgSdOdDBEQndIWJcZfNfO0IjMP5euW0JNzjpdMUp1Yrhz9aGnDrlU9C4dECg" alt="" />
</figure>


</p>
<p>Figure 2: Document used by the SideWinder APT group</p>
<p>The sample in question was identified at the time of writing this post by 31 antivirus engines, leaving no doubt that it is indeed a real malware sample. In the process of pivoting to identify new samples or related infrastructure, starting with Figure 2, the analyst will likely click on the URL detected by 11 out of the 91 engines, and the domains detected by 17 and 15 engines, respectively, to see if there are other samples communicating with them. The remaining two domains (related to windows.com and live.com) in this case are easily identified as legitimate domains that were likely contacted by the sandbox during its execution.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/KwmpkB3Cw8ssqE7HrvoLRilMM-wxDUFcmY0oW-dWfkF1moXeB82z_v0FF27pK7qyEtOfGLdyBqnXzGNFdJZLnFxUz2890pmiyRCThl5p2wB3_immk9PNOG9ktjEz56b9lTZs5VLUMvwoF61DXftK9_fcfCMmdThMSpJlRXk84CtjnveivoNoCdBuafI0EQ" alt="" />
</figure>


</p>
<p>Figure 3: Relationships within the SideWinder APT group document</p>
<p>In the same sample, if you go down in the VirusTotal report (Figure 3), the analyst will likely click on the ZIP file listed as &ldquo;compressed parent&rdquo; to check if there are other samples within this ZIP besides the current one. They may also click on the XML file detected by 8 engines, and the LNK file detected by 4 engines. The remaining files in the bundled files section probably won&rsquo;t be clicked, as the green color indicates they are not malicious, and also because they have less enticing formats — mainly XML and JPEG. But what if we explore them?</p>
<h1 id="xml-files-generated-by-microsoft-office-1">XML files generated by Microsoft Office</h1>
<p>When you create a new Microsoft Office file, it automatically generates a series of embedded XML files containing information about the document. Additionally, if you use images in the document, they are also embedded within it. Microsoft Office files are compressed files (similar to ZIP files). In VirusTotal, when a Microsoft Word file is uploaded, you can see all these embedded files in the embedded files section.</p>
<p>We have mainly focused on three types of embedded files within Office documents:</p>
<ul>
<li>
<p>**Images:**Many threat actors use images related to the organizations or entities they intend to impersonate. They do this to make documents appear legitimate and gain the trust of their victims.</p>
</li>
<li>
<p>**[Content_Types].xml:**This file specifies the content types and relationships within the Office Open XML (OOXML) document. It essentially defines the types of content and how they are organized within the file structure.</p>
</li>
<li>
<p>**Styles.xml:**Stores stylistic definitions for your document. These styles provide consistent formatting instructions for fonts, paragraph spacing, colors, numbering, lists, and much more.</p>
</li>
</ul>
<p>Our hypothesis is: If malicious Microsoft Word documents are copied and pasted during the weaponization building process, with only the content being modified, the hashes of the [Content_Types].xml and styles.xml files will likely remain the same.</p>
<h1 id="office-documents-1">Office documents</h1>
<p>To check our hypothesis, we selected a set of samples used during delivery and belonging the threat actors listed in Figure 4:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/6kd1dSM2J_nvzXZA4svGFwd8MqggvB30sY9NiBDFQwzuRXa8GBN0Ui5jR8gfMxeGztTLTg5qFkvj7CPws0gQlmDydHUhn1JJp9Ftf8N46QDoIvoE3DT5RCH3gK-Hz745O0y2vnyEcDH149bXNr6uMHAQCo1cmUdOQffMScxZCmKFck9HlVMqybWKI9O5zA" alt="" />
</figure>


</p>
<p>Figure 4: Number of samples per actor within the scope</p>
<p>Let’s analyze some of the results we obtained per actor.</p>
<h2 id="apt28--images-1">APT28 – Images</h2>
<p>We started by focusing on images APT28 has reused for different delivery samples (Figure 5).</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CnCsPL8T-i36ADUB_SVjZx9v-qOQELIyMc4b_3T80h8RJPuk3b_FkPujEVRXD1g9HufveUK9QmlqFHOfCl1nIGaNLYQITYrFPZTP3-00Pi9tp6XZpSFTVCau1SgXPzUkjJiIXhk-y1Ax3l_huKsTYdabMD5lRwIDoN3MFo6JqxSDQTvKdx9jTdPBW4FH2A" alt="" />
</figure>


</p>
<p>Figure 5: Images shared in multiple documents by APT28</p>
<p>Each line in the Figure 5 graph represents the same image, and each point represents at least two samples that used that particular image.</p>
<p>The second image of the graph shows how it was used by different Office documents at different points in time, from 2018 to 2022 (dates related to their upload to VirusTotal).</p>
<p>Now, the chart in Figure 6 visualizes each of these images.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/IQ_5NDy3c6PFNw5zr4ekwEANoWYWE_PNnqyx1IbDPzk17vI_hx9NGwBGVC75RQDX3GFpf8SU70mm8yxSmohGNTxv7xQZNrccyMhgwQZlVxfDFfvOWEMl_OAEaY81U8GysGTRXNhw3YNTkixJpPks0Zb5etunSQZalbxdxZdsBuCmMRzkD9sLLLPfXGfEqg" alt="" />
</figure>


</p>
<p>Figure 6: Content of the images shared in multiple documents by APT28</p>
<ul>
<li>
<p>The first image is just a simple line with no particular meaning. It&rsquo;s embedded in over 100 files known by VirusTotal.</p>
</li>
<li>
<p>The second image is a hand and has 14 compressed parents.</p>
</li>
<li>
<p>The third image consists of black circles and also has over 100 compressed parents.</p>
</li>
<li>
<p>The last image is like a Word page with a table, presenting a fake EDA Roadmap of the European Commission. The image format is EMF (an old format) and it has 4 compressed parents</p>
</li>
</ul>
<p>If we delve into the compressed parents of the second image (the one with the hand), we can see how the image is used in Office documents that are part of a campaign reported by Mandiant attributed to APT28. The image of the hand was used in fake Word documents for hotel reservations, particularly in a small section where the client was supposed to sign.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/DcfFdBpuJACB3xyoYf2Vju9h33MJZcmjjJz7zPmZyuFJvKpbnqD3ObYIcHwjJtoPVjbfuGWziN0EElW0_2f-IzXYRqK7i8lBamguXLTHHU-l2BqbkK6niYELIBsERXINY55yQEdPA-_aqbUsmPoPkmyYBidqVfr0DEmfYXtulEUVOgpS2yWTXHnglF8R8A" alt="" />
</figure>


</p>
<p>Figure 7: Pivoting through a specific image used by APT28</p>
<h2 id="sidewinder--images-1">SideWinder – Images</h2>
<p>SideWinder (aka RAZER TIGER) is a group focused on carrying out operations against military targets in Pakistan. This group traditionally reused images, which might help monitoring their activity.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CRkqUEk-iZIvbiR1w1oJ7hRyRRjgD0PyExRL98MpTHWbW2eWhpSsYLxObreZyrqCpsX0Z5fwb1Jq8Uc41ljdIaoqqjKAQs40OFaM53bzNQwmi3KqHtStkPqQFQYlG8Jf3ZQ1lobBbc2tcz6YdiAp83b8GyRioPV4kq821mD1Bv7X9i3w8cMKqpQ5WYx8Kw" alt="" />
</figure>


</p>
<p>Figure 8: Images shared in multiple documents by RAZOR TIGER</p>
<p>In particular, the image in Figure 9 was used in a sample uploaded in September 2021 and in a second one uploaded March 2022. The image in question is the signature of Baber Bilal Haider.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/eZSDnI-aoZj4s9ScYTKBsixIUvsonqoaNjlh6r_CLYrIGkC6xkLhrDHlup2PcKt8def5SuBdfE3EAsH2iDTWgPNQ-WKPI2ej8KM75Ycor70o7i7QIee_IRfVn6OIbDtS8DhabcXoyL_RCCYagO99yoUJ8BgaVGRVVwaLEGQg8RhsT0yi10zYe_-awDfyBQ" alt="" />
</figure>


</p>
<p>Figure 9: Two different samples of RAZOR TIGER share the same image of a handwritten signature</p>
<h2 id="gamaredon--content_typesxml-and-stylesxml-1">Gamaredon – [Content_Types].xml and styles.xml</h2>
<p>For Gamaredon we found they reused styles.xml and [Content_Types].xml in different documents, which helped reveal new samples.</p>
<p>Figure 10 chart displays all the [Content_Types].xml files from Gamaredon&rsquo;s Office documents.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/walAH7apLtyJytKdM3s-zNTaGL0QuAP8q4Y2YN-uQCC1K0zTfhMlPRScq0WvgsQoAqULYUA5_kIgZi8sG9sxrks2i8rkM9IIq-Sf_5TIP_bPBRb3_MTXZVuucpGAoM6QEu1BD5soXk5Yd7pTvT80SbhM52AFILAEDTjNs4qJWyDVAfijGOM297m18dNwsg" alt="" />
</figure>


</p>
<p>Figure 10: [Content_Types].xml shared in multiple documents by Gamaredon Group</p>
<p>There are a large number of samples that share the same [Content_Types].xml. It&rsquo;s important to highlight that these [Content_Types].xml files are not necessarily exclusively used by Gamaredon, and can be found in other legitimate files created by users worldwide. However, some of these [Content_Types].xml might be interesting to monitor.</p>
<p>Styles.xml files are usually less generic, which should make them a better candidate to monitor:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/Y5sasbBbb4dyH-Ocs-rpceryW4CSZNpeVc0ess9zmj_vT_5oxD-uvy3Zh-o8HMbjN7hxeSahpEnywIWgx66Ojd_0HdyECac_xpICX1u4NeXldPjPuUhuK-nhRrpBejFmiKUkdA0SQZuEYusIp_KP0L65saJ0l3F9_LGArqsJ8ucWt3kxzgp5Uzv9Kw0Q9g" alt="" />
</figure>


</p>
<p>Figure 11: Styles.xml shared in multiple documents by Gamaredon Group</p>
<p>We see styles.xml files are less reused than [Content_Types].xml. This could be because some of the samples used by this actor for distribution are created from scratch or reusing legitimate documents.</p>
<p>We used identified patterns in the styles.xml files to launch a retrohunt on VirusTotal. Figure 12 visually represents the original set of style.xml files (left) and those that were added later after running the retrohunt (right).</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/DARhJBD7pfoI_SmFWF8GvauyeGlQ63MpeAzBfYSMzYpSVTNixDTfp0q5B5OBqSXAVtdDeNkjjEI0yf4dZId0Wx-AvzkrwvlMpINo6iG9oCdojGQyC5NhdJJ2xH21AJ03kPkAXuxa9c6xRW6C1kt5Tve9AnYPcVlantydToAB4OIloZtGjTp9oMZ-5GodoQ" alt="" />
</figure>


</p>
<p>Figure 12: Initial graph of the styles.xml and its parents used by Gamaredon (left). Final graph after identifying new styles.xml and their parents using retrohunt in VirusTotal (right)</p>
<p>One of the new styles.xml files found in our retrohunt has 17 compressed parents, meaning it was included in 17 Office files.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/KbSxemTzMcRX7c1ozDFdc45MA1LKrt1hvd_Y-0ruyJJn78ovDvYO-fkXj0PVcHWDjVhc7X4sYOOuRabHnFPSTCDaeY3H9usIrgh6d9y9cdMEWscpI4DmOYF-kwpFEez3KbmKhaRXfa0o3AxLpsK6kTOBaIf1TlKDlGn83ocZMMLOvhtAhxrDQ5weVgOEwg" alt="" />
</figure>


</p>
<p>Figure 13: Number of parent documents for a specific styles.xml file used by Gamaredon</p>
<p>All the parents were malicious, some of them identical and the rest very similar between them. The content of many of them referred to &ldquo;Foreign institutions of Ukraine - Embassy of Ukraine in Hungary,&rdquo; containing a table with phone numbers and information about the embassy, such as social media links and email accounts. Here&rsquo;s an example:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/SOQpaMCcBAQ_Qeuoa9o0V2WiwAFD2i64pJo3Z1WhhpGoTTkKWclGtHfHLvbYizn0fwdCkXJizS1XtxN47Dv4qdbQ3bqcln38e3lTBYIDJgAJ6OJ1VGlkW0ibsMmg_XBaYpIQBoCnd5wls36KFgEMdRi-vHl4Af8dhKlTitAApuVtlqdb03oj2aGFUmDUyQ" alt="" />
</figure>


</p>
<p>Figure 14: Document used by Gamaredon in one of its campaigns that includes multiple images which can be used to monitor new samples</p>
<p>The information for social media includes the logos of these platforms, such as the Facebook logo, Skype logo, an image of a telephone, etc. By pivoting, on the image of the Facebook icon, we find that it has 12 additional compressed parents, meaning it appears in 12 documents, all of them sharing the same styles.xml file.</p>
<p>Visualizing all together, we find a set of about 12-14 images used within the same timeframe by the actor. All of these images can be found in the “Embassy of Ukraine in Hungary” document.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QMEcz0BFywlmsUEaE2M-nECs8rkGmopeamCWMv2kwCgHiTKfDhP3ptEcv1PxXPkcsy3KZV47co9T5gOUQF3rcAhH1OSMQCKK3YQTaFi3WfFAoFSx0eX34rsZG2Cy1UV8OgC74AEk__IX7G_NBwu0P9hf9Hu1OqJ-6lcNRjDo4XZEw8HRr-hHoW8_tuGQvA" alt="" />
</figure>


</p>
<p>Figure 15: Pivoting through the Facebook image that included the document in Figure 14</p>
<p>There&rsquo;s a pattern evident in the previous image where different images were included in files uploaded simultaneously. This pattern is associated with multiple documents used in the same campaign of the Embassy of Ukraine in Hungary, all of them were using the same social media images explained before.</p>
<h2 id="stylesxml-shared-between-threat-actors-2">Styles.xml shared between threat actors</h2>
<p>Another aspect we explored was if different threat actors shared similar styles.xml files in their documents. Styles.xml files are somewhat more specific and unique than [Content_Types].xml files because they can contain styles created by threat actors or by legitimate entities that originally created the document and then were modified by the actor. This makes them stand out more and can help in identifying threat actor activity.</p>
<p>This doesn&rsquo;t necessarily imply they share information to conduct separate operations, although in some cases, it could be a scenario worth considering.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QwJMAXmM58Me8QYbW4DKjXip6nB3MPC6B7fXpGn0F_6_ElYhx2nPPmkgl3Pas41WwAo6BS4hUpb8LAH_2awI7YEA9hZGmBVGaRDvEbrs4ToFy66I2BKUnJjUGmJ_gIyDLQthxljbPW1U7qYnWs4VrzR2_ulDfZh2uNLYqT9nT3zNjYY7UWHozlMhwZS70Q" alt="" />
</figure>


</p>
<p>Figure 16: styles.xml shared between different threat actors</p>
<p>Of all styles.xml files related to actors in our initial set, only six of them were found to be shared by at least two actors. Some styles defined by the styles.xml file are very generic and could identify almost any type of file. However, there are others that could be interesting to explore further.</p>
<p>An interesting case is the Styles.xml file, which seems to be shared by Razor Tiger, APT28, and UAC-0099. Specifically, the samples from APT28 and UAC-0099 are attract because they were uploaded to VirusTotal within short time frames, suggesting they might belong to the same threat actor.</p>
<p>The file 243bab79863327915c315c188c0589202f64b3500a3fee3e2c9f3d34e8e1f154 attributed to APT28, the file 2c2fa6b9fbb6aa270ba0f49ebb361ebf7d36258e1bdfd825bc2faeb738c487ed attributed to UAC-0099, and the file 61a5b971a6b5f9c2b5e9a860c996569da30369ac67108d4b8a71f58311a6e1f1 attributed to UAC-0099 all share the same styles.xml and [Content_Types].xml.</p>
<p>You can see the list of hashes in the appendix of this blog</p>
<h2 id="content_typesxml-shared-between-threat-actors-2">[Content_Types].xml shared between threat actors</h2>
<p>Like in the previous case, we checked if there were Office documents among different threat actors sharing [Content_Types].xml:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/ksdSRbv4YJXoGDU0rDCl5Hg2GmMUtgf-eR7KKIBuRDNAOO9oSLPQGoMlaJmVOH2ji3yBdPJAjVAYxCy0Qm9NjNU2xjiPd7qI8eaVgCd6V0fzF6xSr6jbdWfqtTD7rdpHL34MRQ3HTgx126KV3CwbpFFLn0yW_AxzltGbMRRQidBw7oQuvoh6g5AEZvjaow" alt="" />
</figure>


</p>
<p>Figure 17: [Content_Types].xml shared between different threat actors</p>
<p>In this case, there are eleven [Content_Types].xml files that are shared by at least two different actors.</p>
<p>An interesting case here is the file dfa90f373b8fd8147ee3e4bfe1ee059e536cc1b068f7ec140c3fc0e6554f331a, which is shared by Gamaredon, APT37, Mustang Panda, APT28, SideCopy, and UAC-0099. Again, there could be different explanations for this.</p>
<p>Another interesting case that is worth analyzing in detail is [Content_Types].xml with hash 4ea40d34cfcaf69aa35b405c575c7b87e35c72246f04d2d0c5f381bc50fc8b3d, which is only shared by APT28 and APT29.</p>
<p>You can see the list of hashes in the appendix of this blog</p>
<h2 id="ai-to-the-rescue-1">AI to the rescue</h2>
<p>The images reused by attackers seem to be a promising idea we decided to further explore.</p>
<p>We used the VirusTotal API to download and unzip a set of Office documents used for delivery, this way we obtained all the images. Then we used Gemini to automatically describe what these images were about.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/_8hurXC6ksmGULpXVi9oq81CvGl52yrJujoc8bUdJtQtEyXQ1njcZvgcVAnF_HVezOEZWRDFEngIZ0ofnyXVQy4VMbMXau7Oc-MRBVVnQcO8AegE2oi8MpJFaQQjwSZclXZ4EV24FOFQ9mDIBh5yW6WUgHC_jATMUbVvADdsvry23XF0nCvy3Hjyp9FPhA" alt="" />
</figure>


</p>
<p>Figure 18: Results obtained with Gemini after processing some of the embedded images in the documents used by the threat actors</p>
<p>Figure 18 shows some examples of images that were incorporated by certain actors. There were also other results that were not helpful, mainly related to images that did not show a logo or anything specific that indicated what they were.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/ZfJH60IC-q_i6MPSyzKv8CqPvqYmOxmTboE8L_IY9DruJLoI4PBJO5IR5lzBYrA76aFzXp_kWSgQVTsI_pg5xjviAqIu5JbBdFqzBUQPaTLEd0n3BL2nIg2XJQTg8aFrf8xC8pc8qBSfEPTSt63ID9pJaq373EghKQSPuBUw6ZQriZZBqUjkLKvvIKR_jA" alt="" />
</figure>


</p>
<p>Figure 19: Results obtained with Gemini after processing some of the embedded images in the documents used by the threat actors</p>
<p>Using the VirusTotal API to obtain documents that you might be looking for and combining the results with Gemini to analyze possible images automatically, can potentially help analysts to monitor potential suspicious documents and create your own database of samples using specific images, for example Government images or specific images about companies. This approach is interesting not only for threat hunting but also for brand monitoring.</p>
<h1 id="pdf-documents-1">PDF Documents</h1>
<h2 id="images-dropped-by-acrobat-reader-2">Images dropped by Acrobat Reader</h2>
<p>Unlike Office documents, PDF files don&rsquo;t contain embedded XML files or images, although some PDF files may be created from Office documents. Some of our sandboxes include Adobe Acrobat Reader to open PDF documents which generates a thumbnail of the first page in BMP format. This image is stored in the directory C:UsersAppDataLocalLowAdobeAcrobatDCConnectorIcons. Consequently, our sandboxes provide this BMP image as a dropped file from the PDF, allowing us to pivot.</p>
<p>To illustrate this functionality, see Figure 20 attributed to Blind Eagle, a cybercrime actor associated with Latin America.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/J_4FZ3bEMoo8FCIDgM6PG4D1v_E00bUxPA1xzobzoZUFW-f8zSco0hgFIv1x29lyqzXlHlPlrbvGJ8A7rryI4sCdUB_wXwMsIJfuNYblcYocYkSFSPlYldBja1PuB-jaXtR1wF3vtL-Og6h54yVd4u9qIT9T4KD08JlXs2N-hj3fer42WLftN0QYSSWMow" alt="" />
</figure>


</p>
<p>Figure 20: Content of a PDF file related to Blind Eagle threat actor</p>
<p>Figure 20 was provided by our sandbox. In the &ldquo;relations&rdquo; tab, we can see the BMP image as a dropped file:</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/xw6hpEpeV_jeNm11GqtR2XWP2jnIr_rcfxbBjgKXZuuCAGNnGxiSC4qLA5IHVq983ebawLx2ubJh_um9r_bUM8aodJRCeoz8AAyO_cmRuZAgKhSSKf6Tfur4dyUg1z7neU9cUtFqKCYkJS5mRKoC8F-h7DH-AtuNW-oSHl9PyEUaQimWOi9ua8HBwSpM6Q" alt="" />
</figure>


</p>
<p>Figure 21: BMP file generated by the sandbox that can be used for pivoting</p>
<p>The BMP file itself also shows relations, in particular up to 6 PDF files in the &ldquo;execution parents&rdquo; section. In other words, there are other PDFs that look exactly the same as the initial one.</p>
<p>Typically, many actors engaged in financial crime activities utilize widely spread PDF files to deceive their victims, making this approach highly valuable. Another interesting example we found involves phishing activities targeting a Russian bank called &ldquo;Tinkoff Bank.&rdquo;</p>
<p>The PDF files urge victims to accept an invitation from this bank to participate in a project.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/FbOD9YwQ3eQrENHYsSBPqjWAcJ7LGNn1eKUxlU3XLlq0zUBUbBJl5_8CynQ1Iu0s-6b16R00xNFVLFLwuNphD-vu9W22SCZYBD2fXtlyp-28bE6eNfVk-jrr3ImZnESVo-5E0V7-9NGD4Gp6R6wMz6rInszLpYHEVURZoRNARovoUY1XAQyTkQ2cLVkkaA" alt="" />
</figure>


</p>
<p>Figure 22: The content of a PDF file used by cybercrime actors</p>
<p>Applying the same approach we identified 20 files with identical content, most of them classified as malicious by AV engines.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/STde7dFiRTZqtPJRNzdKFEtxhTUJ_FwQa0TPob1HgsanQ2EqXQYfCFtZFgDzkZGP4v7jjIyXhoOvTC0cwLpqZC3W0cbyBxxx9kocOXyWtv77sfjR10iSwKt_iQsLtsovDnoV_cjZLqYDUvjRqMDjTY5anJCiv5mH1lT6G7NR-KlOJeAV5Uek6ugyLAkE7A" alt="" />
</figure>


</p>
<p>Figure 23: BMP file generated by the sandbox that can be used for pivoting, in this case having other 20 PDF with the same image</p>
<p>There are some limitations to this approach. For instance, the PDF file might be slightly modified (font size, some letter/word, color, …) which would generate a completely different hash value for the thumbnail we use to pivot.</p>
<h2 id="images-dropped-by-acrobat-reader-3">Images dropped by Acrobat Reader</h2>
<p>Just like the BMP files generated by Acrobat Reader, there are other interesting files that might be dropped during sandbox detonation. These artifacts can be useful on some occasions.</p>
<p>The first example is a JavaScript file dropped in another PDF attributed to Blind Eagle.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/c-JSnxdyx_FVOts2J9ivRMqqOFw-aJ8MyG_PN0HAx3BapmCoPSPV213P-ZpxTuxAhCiAdm750nvEafxc1F670C3UJQbfTAM52k394PDwmxmnPCkoYGmfQPboj9914_YVNIbuj9ZCp97pnWWkSH4TVRCFx82pU9Ucedz98OqO3IhT-evMBIhJw7mm63uSMw" alt="" />
</figure>


</p>
<p>Figure 24: BMP file generated by the sandbox that can be used for pivoting, another example of Blind Eagle threat actor</p>
<p>The dropped JavaScript file&rsquo;s name during the PDF execution was &ldquo;Chrome Cache Entry: 566&rdquo; indicating that this file was likely generated by opening an URL through Chrome, possibly triggered by a sandbox click on a link within the PDF. Examining the file&rsquo;s contents, we observe some strings and variables in Spanish.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/cpJvuC9oIbAcHXHn5vm8Kc8KAjkB2Bq1AeaV7hs29lRB0PxDtRypcoOnd8AIZZ8eqyvJMfVenLVb1oHgTDTHrLdPB6KzBz8vkAOcCqaxgVPIZaGB0miGvkkT4EfeW8qISX7vyFod5DqvSlrLe1bPJsCdfr5yqkue2a4XdYuBee-m2836f0xMY3dx86imWA" alt="" />
</figure>


</p>
<p>Figure 25: Artifact generated by the sandbox via Google Chrome when connecting to a domain</p>
<p>The strings “registerResourceDictionary”, “sampleCustomStringId”, “rf_RefinementTitle_ManagedPropertyName” are related to Microsoft SharePoint as we were able to confirm. These files were probably generated after visiting sites that have Microsoft Sharepoint functionalities. We found that all the PDFs containing this artifact dropped by Google Chrome came from a website belonging to the Government of Colombia.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/QYgpWOVmWs9i8td1Gk4VrxhYdrlixNvCYRgJA0daeFQfWKWfDcmsTGgjuhhZI32JqG92EFSvp-kCxwea4Raza0FCP5TaZdTERPZ6w1Ua7S17D_6e0UVhbSwheHcdXP_Gpfbz-ifkpnZT_9mWhfGuGd-56Fvyg0LBNNcoPx_-HBFquXCH1VkmH6hkWEy2CQ" alt="" />
</figure>


</p>
<p>Figure 26: Flow of artifact generation related to Google Chrome that can be used for pivoting in VirusTotal</p>
<h2 id="email-files-1">Email files</h2>
<p>Many threat actors incorporate images in their emails, such as company logos, to deceive victims. We used this to identify several mailing campaigns where the same footer was used.</p>
<h2 id="campaign-impersonating-universities-1">Campaign impersonating universities</h2>
<p>On November 13, 2023, we details about a new campaign impersonating universities, primarily located in Latin America. By leveraging the presence of social network logos in the footer, we were able to find more universities in different continents targeted by the same attacker.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/M7hfVLeq3Bc1GHZfzZaJKG8rzUs5a3dfCl_RU1WlQzRi8DWPX8W_kVIX225YzYMYzUJLPM3GjXDkUD7MNCluw-_hcpb0mYjiKRen2pSJP_4VTzi-HweQ6WET8gOoY2mW0_6_vjzZYoZ7aa6JkxoiCkdV6eQ7aBc3CAKL9zodwBLtmi7N_oxNiSTGPKKssQ" alt="" />
</figure>


</p>
<p>Figure 27: Email impersonating a university that contains multiple images</p>
<p>Figure 27 shows several images, including the University of Chile&rsquo;s logo and building, as well as images related to social networks like YouTube, Facebook, and Twitter.</p>
<p>Pivoting through the images related to the University of Chile doesn&rsquo;t yield good results, as it&rsquo;s too specific. However, if we pivot through the images of the social media footer, represented as email attachments, we can observe multiple files using the same logo.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/l1r2N-4zSX67dxKRm3vA_ze9ejQChIBPmEC9pce7oLE0_QgoCvcCa81csh1o8_obypmRvrCdMDIO55Zcvy3f26fUWLvImwf918LGagevTq4Hk1nhzfOYQLiy0PWz5zvQdIMYeaxP3jSWsCz7k9DCGKqDNl-ucytZZNinR-LJouBKgIaKKKeJexa5VRE9NA" alt="" />
</figure>


</p>
<p>Figure 28: Using the images from the email footer to pivot and identify new emails</p>
<p>Just by analyzing one of the social media logos, we saw 33 email parents, all of them related to the same campaign.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/aauno6BU2EVPf_CXBXN4h2B08BXkCLO7dQSGhg5vGKNW8CcGJVzgBYP5QJmv7tafZV6gvw-30paF2Kex4MecOcQP4Se3_73csJs0KScbhTurkqD7OGKmxEoE4CdvXSfhUVpWRf3yd4a27F4U722KRXYRPM9szOVm_42HiFMhc-RB9exU79vixpf9MlT7KA" alt="" />
</figure>


</p>
<p>Figure 29: Other emails identified through image pivoting techniques</p>
<h2 id="campaigns-impersonating-companies-1">Campaigns impersonating companies</h2>
<p>Another usual case is adding a company logo in the email signatures to enhance credibility. Delivery companies, banks, and suppliers are some of the most observed images during our research.</p>
<p>For example, this email utilizes the corporate image of China Anhui Technology Import and Export Co Ltd in the footer.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/LlZOzxiYkXjWdiLSleQ79w_RVJyKaRqh1M7ne310yqtid97wiW8YZd8M27vm148hqEIY20ZvoCuuh3x9bT6t5aJbKbqwO9kPnU7f4xNPXtA4pHDfcR0zGiVmxGgAUL6ebj8So0dgvjxey8ko99TUXmfOn3pm6oIm07WnnudbxAbOVYBt5nInlbVSYydCcA" alt="" />
</figure>


</p>
<p>Figure 30: Email impersonating a Chinese organization using the company logo in the footer</p>
<p>Pivoting through the image we found 20 emails using the same logo.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/_gIXDeILPZ3P72ekVHi-5_85zHLr-YaxrsmJ7gLgBqsNn1Vwa4bm7vQNF1T7g_Df5RsTwzR4ETCfhfrjI8VA5Yg2IMopiUXuR4RV7c5dSH9eB66MbYuxbFZn3SDHptL91tEbLchhVHVDanBqJy50DPjmj3xmuLm_E8yMnLYoKMqpcHKj7ic-VQWf8kmuHg" alt="" />
</figure>


</p>
<p>Figure 31: Other emails identified through image pivoting techniques</p>
<h1 id="wrapping-up-1">Wrapping up</h1>
<p>We can potentially trace malicious actors by examining artifacts linked to the initial spreading documents, and in the case of images, AI can help us automate potential victim identification and other hunting aspects.</p>
<p>In order to make this even easier, we are planning to incorporate a new bundled_files field into the IOCs JSON structure, which basically will help to create livehunt rules. In the meantime you can use vt_behaviour_files_dropped.sha256 for those scenarios where the files are dropped.</p>
<p>In certain situations, the styles.xml and [Content_Types].xml files within office documents can provide valuable clues for identifying and tracking the same threat actor. The method presented here offers an alternative to traditional hunting or pivoting techniques, serving as a valuable addition to a team&rsquo;s hunting activities.</p>
<p>We hope you found this research interesting and useful, and as always we are happy to hear your feedback.</p>
<p>Happy hunting!</p>
<h1 id="appendix-1">APPENDIX</h1>
<h3 id="content_typesxml-shared-between-threat-actors-3">[Content_types].xml shared between threat actors</h3>
<table>
  <thead>
      <tr>
          <th>[Content_Type].xml sha256</th>
          <th>Shared by</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>3d8578fd41d766740a1f1ddef972a081436a2d70ab1e9552a861e58d8bbf5321</td>
          <td>APT33, APT32</td>
      </tr>
      <tr>
          <td>4ea40d34cfcaf69aa35b405c575c7b87e35c72246f04d2d0c5f381bc50fc8b3d</td>
          <td>APT29, APT28</td>
      </tr>
      <tr>
          <td>4f7fa7433484b4e655d185719613e2f98d017590146d15eedc1aa1d967636b3a</td>
          <td>FIN7, Gamaredon, APT28, APT32</td>
      </tr>
      <tr>
          <td>529739886f6402a9cd5a8064ece73eef19c597ef35c0bc8d09390e8b4de9041b</td>
          <td>FIN7, APT33, TA505, Mustang Panda</td>
      </tr>
      <tr>
          <td>688dca40507fb96630f3df80442266a0354e7c24b7df86be3ea57069b25d12c6</td>
          <td>Gamaredon, APT33</td>
      </tr>
      <tr>
          <td>6f1ac5f0ebfb7e97d3dc4100e88eaab10016a5cac75e1251781f2ea12477af51</td>
          <td>Gamaredon, Hazy Tiger, APT33,</td>
      </tr>
      <tr>
          <td>7796c382cd4c7c4ae3bcf2eed4091fbb20a2563ca88f2aecadb950ad9cf661f8</td>
          <td>Razor Tiger, APT28, UAC-0099</td>
      </tr>
      <tr>
          <td>b4fa7f3faa0510e4d969219bceec2a90e8a48ff28e060db3cdd37ce935c3779c</td>
          <td>Razor Tiger, SideCopy</td>
      </tr>
      <tr>
          <td>dfa90f373b8fd8147ee3e4bfe1ee059e536cc1b068f7ec140c3fc0e6554f331a</td>
          <td>Gamaredon, APT37, Mustang Panda, APT28, UAC-0099, SideCopy</td>
      </tr>
      <tr>
          <td>fe98b3bcf96f9c396eb9193f0f9484ef01d3017257300cc76098854b1f103b69</td>
          <td>FIN7, Hazy Tiger</td>
      </tr>
      <tr>
          <td>ff5a5ba3730a8d2ec0cbad39e5edf4ad502107bd0ef8a5347f29262b3dfe8a43</td>
          <td>Mustang Panda, APT32</td>
      </tr>
  </tbody>
</table>
<h3 id="stylesxml-shared-between-threat-actors-3">styles.xml shared between threat actors</h3>
<table>
  <thead>
      <tr>
          <th>Styles.xml sha256</th>
          <th>Shared by</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>13ed55637980452662cb6838a2931a5e54fbed5881bcbae368b3d189d3a01930</td>
          <td>APT28, UAC-0099, Razor Tiger</td>
      </tr>
      <tr>
          <td>2de1fc9c48c4b0190361c49cdb053fd39cf81e32f12c82d08f88aec34358257f</td>
          <td>Hazy Tiger, Gamaredon, APT33</td>
      </tr>
      <tr>
          <td>59df7787c7cf5408481ae149660858d3af765a0c2cd63d6309b151380f92adb2</td>
          <td>TA505, Gamaredon</td>
      </tr>
      <tr>
          <td>8f590f608f0719404a1731bb70a6ce2db420fd61e5a387d5b3091d47c7e21ac9</td>
          <td>APT28, FIN7, Razor Tiger, APT32, APT33</td>
      </tr>
      <tr>
          <td>de392cd4bf1d650a9cf8c6d24e05e0605bf4eaf1518710f0307d8aceb9e5496c</td>
          <td>Hazy Tiger, FIN7</td>
      </tr>
      <tr>
          <td>e16f84c5fd1df6af1a1f2049f7862f4ea460765863476afb17e78edee772d35b</td>
          <td>APT32, SideCopy, Mustang Panda, Razor Tiger</td>
      </tr>
  </tbody>
</table>
<p>Go to Source</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-21-evolving-together-the-next-chapter-in-o/">Evolving Together The Next Chapter in Our Partner Journey</a></li>
				
				<li><a href="/posts/2025-03-21-this-week-in-security-the-github-supply/">This Week in Security The Github Supply Chain Attack Ransomware Decryption and Paragon</a></li>
				
				<li><a href="/posts/2025-03-21-modernize-your-industrial-infrastructur/">Modernize Your Industrial Infrastructure for Cybersecurity and AI Readiness with Cisco Validated Designs</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2590---code-projects-human-res/">CVE-2025-2590 - Code-projects Human Resource Management System Cross-Site Scripting Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-2589---code-projects-human-res/">CVE-2025-2589 - Code-projects Human Resource Management System Unauthorized Access Vulnerability</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
