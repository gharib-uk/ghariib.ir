<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Following MITRE&#39;s footsteps in analyzing malware behavior</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Following MITRE&#39;s footsteps in analyzing malware behavior</h1>
			<b><time>05.01.2025 00:00</time></b>
		       

			<div>
				<p>The <strong>MITRE</strong> framework helps all defenders speak the same language regarding attackers&rsquo; modus operandi. VirusTotal provides multiple data points where MITRE&rsquo;s Tactics and Techniques are dynamically extracted from samples when detonated in our sandboxes. In particular, samples&rsquo; MITRE mapping can be found under the <strong>BEHAVIOR</strong> tab of a file&rsquo;s report. This data is searchable in <strong>VirusTotal Intelligence</strong> (VTI) with the help of a set of specific file search modifiers.</p>
<p>In this article, we&rsquo;ll illustrate how security analysts can leverage MITRE for malware detection and <strong>behavior</strong>-based hunting for ransomware and keylogger samples.</p>
<h2 id="hunting-for-ransomware">Hunting for Ransomware</h2>
<p>The security industry historically identified a set of commonly used techniques in <strong>Ransomware</strong> campaigns, including inhibiting the system recovery and discovering local files and network shares for later data encryption, usually combined with exfiltration and/or Command and Control techniques.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/Sfy6VIt1uPPGgGIT7Z4OOEy4n5e4EGFnrUc8gJ2vmA4iy11rIrhJpPX6OIwPyY_YPjBnUDV1DIMhp92EosShhWx7NOqD12EJRBmwiiMDHgVRZa9fn1HlU9vI9pkjwXtUWolJGT-bOSmDBKQYbkWNsZfo6svqfKZj37nls0NtB7rcyZYbDoopJBThzBuETUk" alt="" />
</figure>


</p>
<p><em>Common TTPs of modern ransomware groups by Kaspersky</em></p>
<p>In VT Intelligence we can use 2 search modifiers to query files behavior mapped to MITRE ATT&amp;CK:</p>
<ul>
<li><strong>&ldquo;attack_tactic&rdquo;</strong> search modifier followed by the MITRE Tactic ID returns the list of files that, based on our sandboxes analysis reports, execute techniques under the specified tactic. For example:
<ul>
<li>attack_tactic: TA0040</li>
<li>attack_tactic: TA0007</li>
<li>attack_tactic: TA0010</li>
<li>attack_tactic: TA0011</li>
</ul>
</li>
<li><strong>&ldquo;attack_technique&rdquo;</strong> search modifier followed by the MITRE Technique ID returns the list of files that, based on our sandboxes analysis reports, execute the specified technique. For example:
<ul>
<li>attack_technique: T1490</li>
<li>attack_technique: T1083</li>
<li>attack_technique: T1135</li>
<li>attack_technique: T1486</li>
</ul>
</li>
</ul>
<p>In addition to the <strong>&ldquo;attack_tactic&rdquo;</strong> and <strong>&ldquo;attack_technique&rdquo;</strong> modifiers, VirusTotal provides extra modifiers listed on the <strong>Appendix I - Behavior search modifiers</strong> for procedures-based queries at the end of this post.</p>
<p>Let&rsquo;s do an example. We want to find samples given a set of ransomware-related techniques combined with the <strong>&ldquo;behavior:CryptEncrypt&rdquo;</strong> operating system API call (check Appendix I for details). Additionally, we specify the <strong>entity</strong> we are interested in (<strong>files</strong>) and the first submission date (<strong>fs</strong>) to filter out files submitted before 2024-01-01.</p>
<p>The resulting query is as follows:</p>
<p>entity:file attack_technique:T1490 and attack_technique:T1083 and attack_technique: T1135 behavior:CryptEncrypt fs:2024-01-01+</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CJODsRgXlRO5DIZJ9ALfH7vHfk1vrPeMrLeKyfHYyE6aEXcwOokaQnXdkAjPhAJOAKBCLYf2362tKYNFTahlJB2ROe-g7fjDU7VTHj46JPVJR2e1YIEFFYNNfShujhDgGOu_UNLIg7MBUVT4vCAyuSdzWPPtX0R3UoafZDZ9vmCQg3YHAa0YSpHNPk8kcto" alt="" />
</figure>


</p>
<p>Let&rsquo;s analyze in more detail one of the query&rsquo;s resulting files (35619594724871138875db462eda6cf24f2a462e1f812ff27d79131576cd73ab). According to the community, the file belongs to a <strong>BlackHunt</strong> Ransomware campaign threat that compromised multiple companies in Paraguay.</p>
<p>Its BEHAVIOR report tab, provides details on the techniques detected during sample&rsquo;s detonation:</p>
<ul>
<li>
<p><strong>T1490</strong> (<strong>Inhibit System Recovery</strong>), the sample deletes the shadow copies (as highlighted in the <strong>Capabilities</strong> section below) and it also modifies Windows boot settings via bcdedit.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GkWcs4g1wyGjtX7Gim5nkkscFYUL3Ds9K7Ht4xannQdzbeuaHirXpHgJ2hi1Hrmm-gj7tHuDftp_GHp-S2iC4bgyM24tKiI_qZ9Au-S0hIXKYxJ4nhE_doq4GiJt2XiHDMsQ4f3fSDo83JM2wcLHM3-nFlHMS7-s1hkk-zDtSIoIIKAr1un5SnEdoy9E0Gs" alt="" />
</figure>


</p>
</li>
<li>
<p><strong>T1083</strong> and <strong>T1135</strong>: The sample runs discovery processes to get system local files and directories, and also network shares.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/oKZGnV7KWtn9u0Yy8MnMtlCZwIGVXUXOBwFdPWAPW00neqvP8A38MPANlmR4bGjLH219ET8GYO8p4dIkU1KSa54QA7ZEykUw5n7XgolaBb3rixmk81BRH4gyGiwH-cjqNZO-OJrpAH94B8U1TX6xe2O4UpvHnxge268SlAtNx6egYLmq17Jz7CEVH5yyguk" alt="" />
</figure>


</p>
</li>
<li>
<p>The encryption process is visible by the CryptEncrypt operating system API call, functionality provided by the <strong>Advapi32.dll</strong>, and visible under the file&rsquo;s DETAILS tab.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GxvYOSdtoJ1hxfTpVPsWoyRC8Ik-qtVZajTc2QrekN_29V8_YHRz5tc357B4L2jen-Te-IAJDToYxV6aY27TTeIJrg9w2EqrcGtXksE2T1uoTfHqiaK1kVLlQfUUN40IpToKphY01wbEkX58H1ygvhkIhmqwnp2OtWavnAV275sW_AK_g_UxKAoZ3DAq4yg" alt="" />
</figure>


</p>
</li>
</ul>
<h2 id="hunting-for-keyloggers">Hunting for Keyloggers</h2>
<p><strong>Keyloggers</strong> are a particular form of Spyware designed for stealing user data, that commonly share some MITRE Tactics, including collecting data and/or discovering data for later exfiltration and/or Command and Control communication.</p>
<p>For our VTI query we will specify the T1056.001: Input Capture: Keylogging sub-technique of the Collection tactic, which identifies keystrokes interception. Additionally, we use the first submitted time condition (<strong>fs</strong>) and both <strong>Command and Control</strong> or <strong>Exfiltration</strong> tactics (<strong>attack_tactic</strong>), since we are not really interested in restricting the way the data gets outside of the victim environment.</p>
<p>attack_technique:T1056.001 (attack_tactic:TA0011 OR attack_tactic:TA0010) fs:2024-02-15+</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/-B4K35DvGOsz_IIGSlWO5eRuPTx-OEhP08ahdtobWk0LbRz-Bt3Irdr4y1sbbHVmPIUzwQ7aySSTy6fy0PArgeRKC6jcBRp00g3HumoUhcPLN31Vm5KmBDlDRm7F8vGbqR3ZILBRLfeWcvB5XbJbuBv52yRHQT9HGGzcJk9Nu0MhNTm2jqnNMl5ADWPgJUI" alt="" />
</figure>


</p>
<p>One of the retrieved files (975b67e75c046e95b1f418c2db85a726dc5d38c21853c5446393b9805c6d1bd5) with a 25 out of 71 AV detection ratio is cataloged as <strong>Remcos</strong>, a commercial Remote Access Tool with keylogger capabilities among many others, which has been used by several Threat Actors.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GsrIzvLh4clPjXTI-wtMyXA60VmHMhT4udY_kIwH48EKWbBRF3uDeuEMRV5P2mzqj-fn5xOD1xyit9WcJW4IYOamF2IxNcfnwhujYIe8A8s5--YaYHh2cH1rXyOCqoSmzmvOR29bk1XGBkPcZkF2ZEfyjEuO3wu1HP5fn9oZUvNdyTUQg5Ew3yaYU4BjZA4" alt="" />
</figure>


</p>
<p>On its BEHAVIOR tab, we can see details on the <strong>keystrokes</strong> interception performed via polling method. The report also reveals additional functionality, including capturing <strong>screenshots</strong>, reading victims&rsquo; <strong>clipboard</strong> and <strong>geographical location</strong> of the abused device.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/oVUN_Y5ynmn3F4nWGc_UsJekYSEgb20gNrjVpih3BA98sdC3C_GrrKH-f0TwLNAFHnIm9AhMojZNKFKE-ek4xbQk2VNrYE0tSGzRwA1jPhryglQMULHcDI4oM7fBxW9BdO1SYLXvbmX6Zrbd0TJDCX21OLB32byPjZnjt9tAHYevpU3MhMC57MP_qBJpAnU" alt="" />
</figure>



<figure>
  <img src="https://lh7-us.googleusercontent.com/dyRx0PhSvYzDjYGUS2h5W4kwWkNIx3I6axLfGytWY5kvewsw8XaPj2co5P8WAqAT_pxnJVrtldRLKXOVRlfQTzQOtNo90LVrjpqn1vm_tz-5QHxJ7L1nj_HOPtvGcVPAuUW7jIqSCkfEREbshJfj1lm-jzp-QhIjq0sGV26S5Lrzp7VGL8pAkhayd4xDA3U" alt="" />
</figure>


</p>
<h2 id="conclusions">Conclusions</h2>
<p>In this post we have seen using a couple of examples how present the <strong>MITRE</strong> framework is on VirusTotal and how it can be used to search for files with a particular TTP-based behavior using <strong>VirusTotal Intelligence</strong> searches. MITRE-related data is based on behavior detected during samples&rsquo; sandbox detonation.</p>
<p>We have additionally created an Appendix I (below) detailing some of the most interesting behavior-search modifiers you can use in your queries. This fits particularly well with other TTP-based modifiers, allowing you to refine results by adding particular technical characteristics specific for the malware under analysis.</p>
<p>We hope you found this post interesting and useful. For suggestions or feedback please feel free to reach out here, we will be happy to hear from you.</p>
<p>Happy hunting!</p>
<h2 id="appendix-i---behavior-search-modifiers">Appendix I - Behavior search modifiers</h2>
<p>The following search modifiers provide a more granular way of searching files based on their behavior, allowing more restrictive queries while using <strong>Tactics/Techniques</strong> (<strong>&ldquo;attack_tactic&rdquo;</strong>, <strong>&ldquo;attack_technique&rdquo;</strong>) search modifiers.</p>
<ul>
<li>
<p><strong>&ldquo;behavior_processes&rdquo;</strong>: followed by the executable and parameters used to run during the sample dynamic analysis:</p>
</li>
<li>
<p>behavior_processes:&quot;\vssadmin.exe delete shadows /all /quiet&quot;</p>
</li>
<li>
<p>behavior_processes:&ldquo;wbadmin.exe delete catalog -quiet&rdquo;</p>
</li>
<li>
<p>behavior_processes:&quot; tree c:\&quot;</p>
</li>
<li>
<p><strong>&ldquo;behavior_injected_processes&rdquo;</strong>: followed by the executable name with or without extension:</p>
</li>
<li>
<p>behavior_injected_processes:lsass.exe</p>
</li>
<li>
<p>behavior_injected_processes:Wininit.exe</p>
</li>
<li>
<p><strong>&ldquo;behavior_created_processes&rdquo;</strong>: followed by the executable name with or without extension:</p>
</li>
<li>
<p>behavior_created_processes: Wininit.exe NOT name:Wininit.exe</p>
</li>
<li>
<p><strong>&ldquo;behavior_services&rdquo;</strong>: followed by the service name to get files opening or deleting internal services:</p>
</li>
<li>
<p>behavior_services: sysmon</p>
</li>
<li>
<p><strong>&ldquo;behavior_registry&rdquo;</strong>: followed by a system registry key to check for new, deleted or modified registry keys:</p>
</li>
<li>
<p>behavior_registry:&ldquo;SoftwareMicrosoftWindowsCurrentVersionRun&rdquo;</p>
</li>
<li>
<p><strong>&ldquo;behavior_network&rdquo;</strong>: followed by an URL, domain or IP address to identify files communicating with those network elements:</p>
</li>
<li>
<p>behavior_network:ip-api.com</p>
</li>
<li>
<p><strong>&ldquo;behavior_files&rdquo;</strong>: followed by the file name with or without extension and/or path to identify files that were opened, written, deleted or dropped:</p>
</li>
<li>
<p>behavior_files: &ldquo;C:ProgramDataVaccine.txt&rdquo;</p>
</li>
<li>
<p>behavior_files: &ldquo;MicrosoftWindowsStart MenuProgramsStartup*&rdquo;</p>
</li>
<li>
<p><strong>&ldquo;behavior&rdquo;</strong>: all the previous search modifiers in the appendix can be replaced by this one. It matches against the whole file behavior report and provides a way to check for other data that doesn&rsquo;t have a specific search modifier assigned:</p>
</li>
<li>
<p><strong>API calls</strong>: <strong>Calls Highlighted</strong> subsection under <strong>Highlighted actions</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior: CryptEncrypt</p>
</li>
<li>
<p>behavior: IsDebuggerPresent</p>
</li>
<li>
<p>behavior: IsWow64Process</p>
</li>
<li>
<p>behavior: GetSystemMetrics</p>
</li>
<li>
<p>behavior: GetAsyncKeyState</p>
</li>
<li>
<p><strong>Mutexes</strong> created or opened, under the <strong>Synchronization mechanisms &amp; Signals</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior:BLACK_HUNT_MUTEX</p>
</li>
<li>
<p><strong>Modules loaded</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior:CRYPTSP.DLL</p>
</li>
<li>
<p><strong>&ldquo;behavior_tags&rdquo;</strong>: followed by the tag of your interest to get files assigned with the indicated tag that you can check here.</p>
</li>
<li>
<p>behavior_tags:detect_debug_environment</p>
</li>
</ul>
<p>The <strong>MITRE</strong> framework helps all defenders speak the same language regarding attackers&rsquo; modus operandi. VirusTotal provides multiple data points where MITRE&rsquo;s Tactics and Techniques are dynamically extracted from samples when detonated in our sandboxes. In particular, samples&rsquo; MITRE mapping can be found under the <strong>BEHAVIOR</strong> tab of a file&rsquo;s report. This data is searchable in <strong>VirusTotal Intelligence</strong> (VTI) with the help of a set of specific file search modifiers.</p>
<p>In this article, we&rsquo;ll illustrate how security analysts can leverage MITRE for malware detection and <strong>behavior</strong>-based hunting for ransomware and keylogger samples.</p>
<h2 id="hunting-for-ransomware-1">Hunting for Ransomware</h2>
<p>The security industry historically identified a set of commonly used techniques in <strong>Ransomware</strong> campaigns, including inhibiting the system recovery and discovering local files and network shares for later data encryption, usually combined with exfiltration and/or Command and Control techniques.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/Sfy6VIt1uPPGgGIT7Z4OOEy4n5e4EGFnrUc8gJ2vmA4iy11rIrhJpPX6OIwPyY_YPjBnUDV1DIMhp92EosShhWx7NOqD12EJRBmwiiMDHgVRZa9fn1HlU9vI9pkjwXtUWolJGT-bOSmDBKQYbkWNsZfo6svqfKZj37nls0NtB7rcyZYbDoopJBThzBuETUk" alt="" />
</figure>


</p>
<p><em>Common TTPs of modern ransomware groups by Kaspersky</em></p>
<p>In VT Intelligence we can use 2 search modifiers to query files behavior mapped to MITRE ATT&amp;CK:</p>
<ul>
<li><strong>&ldquo;attack_tactic&rdquo;</strong> search modifier followed by the MITRE Tactic ID returns the list of files that, based on our sandboxes analysis reports, execute techniques under the specified tactic. For example:
<ul>
<li>attack_tactic: TA0040</li>
<li>attack_tactic: TA0007</li>
<li>attack_tactic: TA0010</li>
<li>attack_tactic: TA0011</li>
</ul>
</li>
<li><strong>&ldquo;attack_technique&rdquo;</strong> search modifier followed by the MITRE Technique ID returns the list of files that, based on our sandboxes analysis reports, execute the specified technique. For example:
<ul>
<li>attack_technique: T1490</li>
<li>attack_technique: T1083</li>
<li>attack_technique: T1135</li>
<li>attack_technique: T1486</li>
</ul>
</li>
</ul>
<p>In addition to the <strong>&ldquo;attack_tactic&rdquo;</strong> and <strong>&ldquo;attack_technique&rdquo;</strong> modifiers, VirusTotal provides extra modifiers listed on the <strong>Appendix I - Behavior search modifiers</strong> for procedures-based queries at the end of this post.</p>
<p>Let&rsquo;s do an example. We want to find samples given a set of ransomware-related techniques combined with the <strong>&ldquo;behavior:CryptEncrypt&rdquo;</strong> operating system API call (check Appendix I for details). Additionally, we specify the <strong>entity</strong> we are interested in (<strong>files</strong>) and the first submission date (<strong>fs</strong>) to filter out files submitted before 2024-01-01.</p>
<p>The resulting query is as follows:</p>
<p>entity:file attack_technique:T1490 and attack_technique:T1083 and attack_technique: T1135 behavior:CryptEncrypt fs:2024-01-01+</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/CJODsRgXlRO5DIZJ9ALfH7vHfk1vrPeMrLeKyfHYyE6aEXcwOokaQnXdkAjPhAJOAKBCLYf2362tKYNFTahlJB2ROe-g7fjDU7VTHj46JPVJR2e1YIEFFYNNfShujhDgGOu_UNLIg7MBUVT4vCAyuSdzWPPtX0R3UoafZDZ9vmCQg3YHAa0YSpHNPk8kcto" alt="" />
</figure>


</p>
<p>Let&rsquo;s analyze in more detail one of the query&rsquo;s resulting files (35619594724871138875db462eda6cf24f2a462e1f812ff27d79131576cd73ab). According to the community, the file belongs to a <strong>BlackHunt</strong> Ransomware campaign threat that compromised multiple companies in Paraguay.</p>
<p>Its BEHAVIOR report tab, provides details on the techniques detected during sample&rsquo;s detonation:</p>
<ul>
<li>
<p><strong>T1490</strong> (<strong>Inhibit System Recovery</strong>), the sample deletes the shadow copies (as highlighted in the <strong>Capabilities</strong> section below) and it also modifies Windows boot settings via bcdedit.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GkWcs4g1wyGjtX7Gim5nkkscFYUL3Ds9K7Ht4xannQdzbeuaHirXpHgJ2hi1Hrmm-gj7tHuDftp_GHp-S2iC4bgyM24tKiI_qZ9Au-S0hIXKYxJ4nhE_doq4GiJt2XiHDMsQ4f3fSDo83JM2wcLHM3-nFlHMS7-s1hkk-zDtSIoIIKAr1un5SnEdoy9E0Gs" alt="" />
</figure>


</p>
</li>
<li>
<p><strong>T1083</strong> and <strong>T1135</strong>: The sample runs discovery processes to get system local files and directories, and also network shares.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/oKZGnV7KWtn9u0Yy8MnMtlCZwIGVXUXOBwFdPWAPW00neqvP8A38MPANlmR4bGjLH219ET8GYO8p4dIkU1KSa54QA7ZEykUw5n7XgolaBb3rixmk81BRH4gyGiwH-cjqNZO-OJrpAH94B8U1TX6xe2O4UpvHnxge268SlAtNx6egYLmq17Jz7CEVH5yyguk" alt="" />
</figure>


</p>
</li>
<li>
<p>The encryption process is visible by the CryptEncrypt operating system API call, functionality provided by the <strong>Advapi32.dll</strong>, and visible under the file&rsquo;s DETAILS tab.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GxvYOSdtoJ1hxfTpVPsWoyRC8Ik-qtVZajTc2QrekN_29V8_YHRz5tc357B4L2jen-Te-IAJDToYxV6aY27TTeIJrg9w2EqrcGtXksE2T1uoTfHqiaK1kVLlQfUUN40IpToKphY01wbEkX58H1ygvhkIhmqwnp2OtWavnAV275sW_AK_g_UxKAoZ3DAq4yg" alt="" />
</figure>


</p>
</li>
</ul>
<h2 id="hunting-for-keyloggers-1">Hunting for Keyloggers</h2>
<p><strong>Keyloggers</strong> are a particular form of Spyware designed for stealing user data, that commonly share some MITRE Tactics, including collecting data and/or discovering data for later exfiltration and/or Command and Control communication.</p>
<p>For our VTI query we will specify the T1056.001: Input Capture: Keylogging sub-technique of the Collection tactic, which identifies keystrokes interception. Additionally, we use the first submitted time condition (<strong>fs</strong>) and both <strong>Command and Control</strong> or <strong>Exfiltration</strong> tactics (<strong>attack_tactic</strong>), since we are not really interested in restricting the way the data gets outside of the victim environment.</p>
<p>attack_technique:T1056.001 (attack_tactic:TA0011 OR attack_tactic:TA0010) fs:2024-02-15+</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/-B4K35DvGOsz_IIGSlWO5eRuPTx-OEhP08ahdtobWk0LbRz-Bt3Irdr4y1sbbHVmPIUzwQ7aySSTy6fy0PArgeRKC6jcBRp00g3HumoUhcPLN31Vm5KmBDlDRm7F8vGbqR3ZILBRLfeWcvB5XbJbuBv52yRHQT9HGGzcJk9Nu0MhNTm2jqnNMl5ADWPgJUI" alt="" />
</figure>


</p>
<p>One of the retrieved files (975b67e75c046e95b1f418c2db85a726dc5d38c21853c5446393b9805c6d1bd5) with a 25 out of 71 AV detection ratio is cataloged as <strong>Remcos</strong>, a commercial Remote Access Tool with keylogger capabilities among many others, which has been used by several Threat Actors.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/GsrIzvLh4clPjXTI-wtMyXA60VmHMhT4udY_kIwH48EKWbBRF3uDeuEMRV5P2mzqj-fn5xOD1xyit9WcJW4IYOamF2IxNcfnwhujYIe8A8s5--YaYHh2cH1rXyOCqoSmzmvOR29bk1XGBkPcZkF2ZEfyjEuO3wu1HP5fn9oZUvNdyTUQg5Ew3yaYU4BjZA4" alt="" />
</figure>


</p>
<p>On its BEHAVIOR tab, we can see details on the <strong>keystrokes</strong> interception performed via polling method. The report also reveals additional functionality, including capturing <strong>screenshots</strong>, reading victims&rsquo; <strong>clipboard</strong> and <strong>geographical location</strong> of the abused device.</p>
<p>
<figure>
  <img src="https://lh7-us.googleusercontent.com/oVUN_Y5ynmn3F4nWGc_UsJekYSEgb20gNrjVpih3BA98sdC3C_GrrKH-f0TwLNAFHnIm9AhMojZNKFKE-ek4xbQk2VNrYE0tSGzRwA1jPhryglQMULHcDI4oM7fBxW9BdO1SYLXvbmX6Zrbd0TJDCX21OLB32byPjZnjt9tAHYevpU3MhMC57MP_qBJpAnU" alt="" />
</figure>



<figure>
  <img src="https://lh7-us.googleusercontent.com/dyRx0PhSvYzDjYGUS2h5W4kwWkNIx3I6axLfGytWY5kvewsw8XaPj2co5P8WAqAT_pxnJVrtldRLKXOVRlfQTzQOtNo90LVrjpqn1vm_tz-5QHxJ7L1nj_HOPtvGcVPAuUW7jIqSCkfEREbshJfj1lm-jzp-QhIjq0sGV26S5Lrzp7VGL8pAkhayd4xDA3U" alt="" />
</figure>


</p>
<h2 id="conclusions-1">Conclusions</h2>
<p>In this post we have seen using a couple of examples how present the <strong>MITRE</strong> framework is on VirusTotal and how it can be used to search for files with a particular TTP-based behavior using <strong>VirusTotal Intelligence</strong> searches. MITRE-related data is based on behavior detected during samples&rsquo; sandbox detonation.</p>
<p>We have additionally created an Appendix I (below) detailing some of the most interesting behavior-search modifiers you can use in your queries. This fits particularly well with other TTP-based modifiers, allowing you to refine results by adding particular technical characteristics specific for the malware under analysis.</p>
<p>We hope you found this post interesting and useful. For suggestions or feedback please feel free to reach out here, we will be happy to hear from you.</p>
<p>Happy hunting!</p>
<h2 id="appendix-i---behavior-search-modifiers-1">Appendix I - Behavior search modifiers</h2>
<p>The following search modifiers provide a more granular way of searching files based on their behavior, allowing more restrictive queries while using <strong>Tactics/Techniques</strong> (<strong>&ldquo;attack_tactic&rdquo;</strong>, <strong>&ldquo;attack_technique&rdquo;</strong>) search modifiers.</p>
<ul>
<li>
<p><strong>&ldquo;behavior_processes&rdquo;</strong>: followed by the executable and parameters used to run during the sample dynamic analysis:</p>
</li>
<li>
<p>behavior_processes:&quot;\vssadmin.exe delete shadows /all /quiet&quot;</p>
</li>
<li>
<p>behavior_processes:&ldquo;wbadmin.exe delete catalog -quiet&rdquo;</p>
</li>
<li>
<p>behavior_processes:&quot; tree c:\&quot;</p>
</li>
<li>
<p><strong>&ldquo;behavior_injected_processes&rdquo;</strong>: followed by the executable name with or without extension:</p>
</li>
<li>
<p>behavior_injected_processes:lsass.exe</p>
</li>
<li>
<p>behavior_injected_processes:Wininit.exe</p>
</li>
<li>
<p><strong>&ldquo;behavior_created_processes&rdquo;</strong>: followed by the executable name with or without extension:</p>
</li>
<li>
<p>behavior_created_processes: Wininit.exe NOT name:Wininit.exe</p>
</li>
<li>
<p><strong>&ldquo;behavior_services&rdquo;</strong>: followed by the service name to get files opening or deleting internal services:</p>
</li>
<li>
<p>behavior_services: sysmon</p>
</li>
<li>
<p><strong>&ldquo;behavior_registry&rdquo;</strong>: followed by a system registry key to check for new, deleted or modified registry keys:</p>
</li>
<li>
<p>behavior_registry:&ldquo;SoftwareMicrosoftWindowsCurrentVersionRun&rdquo;</p>
</li>
<li>
<p><strong>&ldquo;behavior_network&rdquo;</strong>: followed by an URL, domain or IP address to identify files communicating with those network elements:</p>
</li>
<li>
<p>behavior_network:ip-api.com</p>
</li>
<li>
<p><strong>&ldquo;behavior_files&rdquo;</strong>: followed by the file name with or without extension and/or path to identify files that were opened, written, deleted or dropped:</p>
</li>
<li>
<p>behavior_files: &ldquo;C:ProgramDataVaccine.txt&rdquo;</p>
</li>
<li>
<p>behavior_files: &ldquo;MicrosoftWindowsStart MenuProgramsStartup*&rdquo;</p>
</li>
<li>
<p><strong>&ldquo;behavior&rdquo;</strong>: all the previous search modifiers in the appendix can be replaced by this one. It matches against the whole file behavior report and provides a way to check for other data that doesn&rsquo;t have a specific search modifier assigned:</p>
</li>
<li>
<p><strong>API calls</strong>: <strong>Calls Highlighted</strong> subsection under <strong>Highlighted actions</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior: CryptEncrypt</p>
</li>
<li>
<p>behavior: IsDebuggerPresent</p>
</li>
<li>
<p>behavior: IsWow64Process</p>
</li>
<li>
<p>behavior: GetSystemMetrics</p>
</li>
<li>
<p>behavior: GetAsyncKeyState</p>
</li>
<li>
<p><strong>Mutexes</strong> created or opened, under the <strong>Synchronization mechanisms &amp; Signals</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior:BLACK_HUNT_MUTEX</p>
</li>
<li>
<p><strong>Modules loaded</strong> section of a file behavior report:</p>
</li>
<li>
<p>behavior:CRYPTSP.DLL</p>
</li>
<li>
<p><strong>&ldquo;behavior_tags&rdquo;</strong>: followed by the tag of your interest to get files assigned with the indicated tag that you can check here.</p>
</li>
<li>
<p>behavior_tags:detect_debug_environment</p>
</li>
</ul>
<p>Go to Source</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-20-cve-2025-2557---audi-utr-dashcam-20-com/">CVE-2025-2557 - Audi UTR Dashcam 20 Command API Local Network Access Control Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-20-cve-2025-29980---etrakitnet-sql-injecti/">CVE-2025-29980 - eTRAKiTnet SQL Injection Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-20-cve-2025-30160---redlib-deflate-decompr/">CVE-2025-30160 - Redlib DEFLATE Decompression Bomb Denial-of-Service Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-20-cve-2025-29217---tenda-w18e-stack-overf/">CVE-2025-29217 - Tenda W18E Stack Overflow Denial of Service Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-20-cve-2025-29218---tenda-w18e-stack-overf/">CVE-2025-29218 - Tenda W18E Stack Overflow Vulnerability</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
