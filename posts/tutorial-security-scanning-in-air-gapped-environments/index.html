<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>&lt;div&gt;Tutorial: Security scanning in air-gapped environments&lt;/div&gt;</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	==========================<br>
	== <a href="https://ghariib.ir/">Gharib Personal Blog</a> ==<br>
	==========================
	<div style="float: right;">A Techi Personal Blog</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>&lt;div&gt;Tutorial: Security scanning in air-gapped environments&lt;/div&gt;</h1>
			<b><time>06.02.2025 00:00</time></b>
		       
		           <a href="/tags/development">development</a>
        	       
		           <a href="/tags/git">git</a>
        	       
		           <a href="/tags/github">github</a>
        	       
		           <a href="/tags/gitlab">gitlab</a>
        	       
		           <a href="/tags/software">software</a>
        	       

			<div>
				<p>Air-gapped environments are computer networks or systems that are physically isolated from unsecured networks, such as the public internet or unsecured local area networks. This isolation is implemented as a security measure to protect sensitive data and critical systems from external cyber threats by providing:</p>
<ul>
<li>Enhanced security: By physically isolating systems from external networks, air-gapped environments help prevent remote attacks, malware infections, and unauthorized data access. This is crucial for highly sensitive data and critical systems.</li>
<li>Data protection: Air-gapping provides the strongest protection against data exfiltration since there&rsquo;s no direct connection that attackers could use to steal information.</li>
<li>Critical infrastructure protection: For systems that control vital infrastructure (like power plants, water treatment facilities, or military systems), air-gapping helps prevent potentially catastrophic cyber attacks.</li>
<li>Compliance requirements: Many regulatory frameworks require air-gapping for certain types of sensitive data or critical systems, particularly in government, healthcare, and financial sectors.</li>
<li>Malware protection: Without network connectivity, systems are protected from network-based malware infections and ransomware attacks.</li>
</ul>
<p>Even though air-gapped systems are isolated, they can still have vulnerabilities. Regular security scanning helps identify these weaknesses before they can be exploited. In this article, you will learn the different security scanners GitLab provides and how they can be added/updated in a limited-connectivity environment.</p>
<h2 id="gitlab-security-scanners-in-air-gapped-environments">GitLab security scanners in air-gapped environments</h2>
<p>GitLab provides a variety of different security scanners for the complete application lifecycle. The scanners that support air-gapped environments include:</p>
<ul>
<li>Static Application Security Testing (SAST)</li>
<li>Dynamic Application Security Testing (DAST)</li>
<li>Secret Detection</li>
<li>Container Scanning</li>
<li>Dependency Scanning</li>
<li>API Fuzzing</li>
<li>License Scanning</li>
</ul>
<p>By default, GitLab Self-Managed instances pull security scanner images from the public GitLab container registry (registry.gitlab.com) and store them within the built-in local GitLab container registry. I will demonstrate this flow below by running the following pipeline that scans for secrets on a sample project:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">include</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">template</span>: <span style="color:#ae81ff">Jobs/Secret-Detection.gitlab-ci.yml</span>
</span></span></code></pre></div><p>When running the job in an internet-connected GitLab instance the job passes:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/1xjIX1SEB9aG51s9Y71EiE/30da85dd73d7c426408bc3e38f4f6eac/pass-1.png" alt="GitLab Runner with internet access successfully pulling from external registry" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --> However, If I disable internet access to the VM running GitLab, the <code>secret-detection</code> job will fail to download the container image, causing the job to fail:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/25NWzvQA2RceTQlb2aLmzk/fa6e62e89a3835be5b9ff02a8fb245da/fail-1.png" alt="GitLab Runner without internet access failing to pull from external registry" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Alternatively, if I set my GitLab Runners’ pull image policy to <code>if-not-present</code> from <code>always</code>, I can load the cached version of the scanner if it was run before on the internet by using the image stored in our local docker:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/48sKSLIBwq6wuqo6jLCMg6/c286af66ec43c2aefd67d3735d175c57/pass-2.png" alt="GitLab Runner without internet access successfully pulling from internal registry cache" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="setting-up-offline-scanning-prerequisites">Setting up offline scanning prerequisites</h3>
<p>Running these security scanners in an air-gapped environment requires the following:</p>
<ul>
<li>GitLab Ultimate subscription</li>
<li>Offline cloud license</li>
<li>GitLab Self-Managed cluster</li>
</ul>
<p>You can follow along with this tutorial in any GitLab Self-Managed EE instance (even those that are not air-gapped) to learn how to transfer and run images in an air-gapped environment. In this tutorial, I will demonstrate how to load scanner images onto a GitLab-EE instance running in a Google Compute VM where I cut off the <code>EGRESS</code> to everything by implementing firewall rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># egress firewall rule to block all outbound traffic to the internet</span>
</span></span><span style="display:flex;"><span>$ gcloud compute firewall-rules create deny-internet-egress 
</span></span><span style="display:flex;"><span>    --direction<span style="color:#f92672">=</span>EGRESS 
</span></span><span style="display:flex;"><span>    --priority<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span> 
</span></span><span style="display:flex;"><span>    --network<span style="color:#f92672">=</span>default 
</span></span><span style="display:flex;"><span>    --action<span style="color:#f92672">=</span>DENY 
</span></span><span style="display:flex;"><span>    --rules<span style="color:#f92672">=</span>all 
</span></span><span style="display:flex;"><span>    --destination-ranges<span style="color:#f92672">=</span>0.0.0.0/0 
</span></span><span style="display:flex;"><span>    --target-tags<span style="color:#f92672">=</span>no-internet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create an allow rule for internal traffic with higher priority</span>
</span></span><span style="display:flex;"><span>$ gcloud compute firewall-rules create allow-internal-egress 
</span></span><span style="display:flex;"><span>    --direction<span style="color:#f92672">=</span>EGRESS 
</span></span><span style="display:flex;"><span>    --priority<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span> 
</span></span><span style="display:flex;"><span>    --network<span style="color:#f92672">=</span>default 
</span></span><span style="display:flex;"><span>    --action<span style="color:#f92672">=</span>ALLOW 
</span></span><span style="display:flex;"><span>    --rules<span style="color:#f92672">=</span>all 
</span></span><span style="display:flex;"><span>    --destination-ranges<span style="color:#f92672">=</span>10.0.0.0/8,192.168.0.0/16,172.16.0.0/12 
</span></span><span style="display:flex;"><span>    --target-tags<span style="color:#f92672">=</span>no-internet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply tag to VM</span>
</span></span><span style="display:flex;"><span>$ gcloud compute instances add-tags YOUR_VM_NAME 
</span></span><span style="display:flex;"><span>    --zone<span style="color:#f92672">=</span>YOUR_ZONE 
</span></span><span style="display:flex;"><span>    --tags<span style="color:#f92672">=</span>no-internet
</span></span></code></pre></div><p>Then, once I SSH into my VM, you can see we cannot connect to registry.gitlab.com:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># showing I can’t access the gitlab container registry</span>
</span></span><span style="display:flex;"><span>$ ping registry.gitlab.com
</span></span><span style="display:flex;"><span>PING registry.gitlab.com <span style="color:#f92672">(</span>35.227.35.254<span style="color:#f92672">)</span> 56<span style="color:#f92672">(</span>84<span style="color:#f92672">)</span> bytes of data.
</span></span><span style="display:flex;"><span>^C
</span></span><span style="display:flex;"><span>--- registry.gitlab.com ping statistics ---
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> packets transmitted, <span style="color:#ae81ff">0</span> received, 100% packet loss, time 2031ms
</span></span></code></pre></div><p><strong>Note:</strong> I am still allowing ingress so I can copy files and SSH into the machine.</p>
<h2 id="load-security-scanners-in-air-gapped-environments">Load security scanners in air-gapped environments</h2>
<p>To use the various security scanners on air-gapped environments, the GitLab Runner must be able to fetch the scanner container images from GitLab’s built-in container registry. This means that the container images for the security scanners must be downloaded and packaged in a separate environment with access to the public internet. The process of loading security scanners onto an air-gapped environment includes the following:</p>
<ol>
<li>Download and package container images from the public internet.</li>
<li>Transfer images to offline environment.</li>
<li>Load transferred images into offline container registry.</li>
</ol>
<p>Now let’s go over how we can implement GitLab Secret Detection in an air-gapped environment.</p>
<h3 id="download-and-package-container-images-from-public-internet">Download and package container images from public internet</h3>
<p>Let’s download the container image for secret detection and store it within our local container registry. Other scanner images can be found in the offline deployments documentation. I will be using Podman desktop to download these images, but you can use Docker desktop or other alternatives.</p>
<ol>
<li>Pull the GitLab Secret Detection image.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ podman pull registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>Trying to pull registry.gitlab.com/security-products/secrets:6...
</span></span><span style="display:flex;"><span>Getting image source signatures
</span></span><span style="display:flex;"><span>Copying blob sha256:999745130ac045f2b1c29ecce088b43fc4a95bbb82b7960fb7b8abe0e3801bf8
</span></span><span style="display:flex;"><span>Copying blob sha256:a4f7c013bb259c146cd8455b7c3943df7ed84b157e42a2348eef16546d8179b1
</span></span><span style="display:flex;"><span>Copying blob sha256:1f3e46996e2966e4faa5846e56e76e3748b7315e2ded61476c24403d592134f0
</span></span><span style="display:flex;"><span>Copying blob sha256:400a41f248eb3c870bd2b07073632c49f1e164c8efad56ea3b24098a657ec625
</span></span><span style="display:flex;"><span>Copying blob sha256:9090f17a5a1bb80bcc6f393b0715210568dd0a7749286e3334a1a08fb32d34e6
</span></span><span style="display:flex;"><span>Copying blob sha256:c7569783959081164164780f6c1b0bbe1271ee8d291d3e07b2749ae741621ea3
</span></span><span style="display:flex;"><span>Copying blob sha256:20c7ca6108f808ad5905f6db4f7e3c02b21b69abdea8b45abfa34c0a2ba8bdb5
</span></span><span style="display:flex;"><span>Copying blob sha256:e8645a00be64d77c6ff301593ce34cd8c17ffb2b36252ca0f2588009a7918d2e
</span></span><span style="display:flex;"><span>Copying config sha256:0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>Writing manifest to image destination
</span></span><span style="display:flex;"><span>WARNING: image platform <span style="color:#f92672">(</span>linux/amd64<span style="color:#f92672">)</span> does not match the expected platform <span style="color:#f92672">(</span>linux/arm64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ podman images
</span></span><span style="display:flex;"><span>REPOSITORY                                                  TAG         IMAGE ID      CREATED      SIZE
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets               <span style="color:#ae81ff">6</span>           0235ed43fc7f  <span style="color:#ae81ff">4</span> hours ago  85.3 MB
</span></span></code></pre></div><ol start="2">
<li>Save the image as a tarball.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ podman save -o secret-detection.tar registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>$ chmod +r secret-detection.tar
</span></span><span style="display:flex;"><span>$ ls -al secret-detection.tar
</span></span><span style="display:flex;"><span>-rw-r--r--@ <span style="color:#ae81ff">1</span> fern  staff  <span style="color:#ae81ff">85324800</span> Jan <span style="color:#ae81ff">10</span> 10:25 secret-detection.tar
</span></span></code></pre></div><p>Alternatively, you can use the official GitLab template on an environment with internet access to download the container images needed for the security scanners and save them as job artifacts or push them to the container registry of the project where the pipeline is executed.</p>
<h3 id="transfer-images-to-offline-environment">Transfer images to offline environment</h3>
<p>Next, let&rsquo;s transfer the tarball to our air-gapped environment. This can be done in several ways, depending on your needs, such as:</p>
<ul>
<li>Physical media transfer</li>
<li>Data diodes</li>
<li>Guard systems</li>
<li>Cross-domain solutions (CDS)</li>
</ul>
<p>I will SCP (Secure Copy Protocol) the tarball directly to my VM that does not have egress access, but does allow ingress. As this is just for demonstration purposes, make sure to consult your organization&rsquo;s security policies and transfer procedures for air-gapped environments.</p>
<h4 id="verify-the-image-is-not-cached">Verify the image is not cached</h4>
<p>Before transferring the file, I’ll delete the Docker images on my GitLab instance pertaining to secret detection to make sure they aren&rsquo;t cached:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker images
</span></span><span style="display:flex;"><span>REPOSITORY                                                          TAG              IMAGE ID       CREATED        SIZE
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets                       <span style="color:#ae81ff">6</span>                0235ed43fc7f   <span style="color:#ae81ff">9</span> hours ago    84.8MB
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets                       &lt;none&gt;           16d88433af61   <span style="color:#ae81ff">17</span> hours ago   74.9MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ docker image rmi 16d88433af61 -f
</span></span><span style="display:flex;"><span>Untagged: registry.gitlab.com/security-products/secrets@sha256:f331da6631d791fcd58d3f23d868475a520f50b02d64000e2faf1def66c75d48
</span></span><span style="display:flex;"><span>Deleted: sha256:16d88433af618f0b405945031de39fe40b3e8ef1bddb91ca036de0f5b32399d7
</span></span><span style="display:flex;"><span>Deleted: sha256:1bb06f72f06810e95a70039e797481736e492201f51a03b02d27db055248ab6f
</span></span><span style="display:flex;"><span>Deleted: sha256:a5ef2325ce4be9b39993ce301f8ed7aad1c854d7ee66f26a56a96967c6606510
</span></span><span style="display:flex;"><span>Deleted: sha256:f7cdac818a36d6c023763b76a6589c0db7609ca883306af4f38b819e62f29471
</span></span><span style="display:flex;"><span>Deleted: sha256:5eabf4d47287dee9887b9692d55c8b5f848b50b3b7248f67913036014e74a0e9
</span></span><span style="display:flex;"><span>Deleted: sha256:51b7cb600604c0737356f17bc02c22bac3a63697f0bf95ba7bacb5b421fdb7da
</span></span><span style="display:flex;"><span>Deleted: sha256:1546193b011d192aa769a15d3fdd55eb4e187f201f5ff7506243abb02525dc06
</span></span><span style="display:flex;"><span>Deleted: sha256:1ea72408d0484c3059cc0008539e6f494dc829caa1a97d156795687d42d9cb57
</span></span><span style="display:flex;"><span>Deleted: sha256:1313ee9da7716d85f63cfdd1129f715e9bbb6c9c0306e4708ee73672b3e40f26
</span></span><span style="display:flex;"><span>Deleted: sha256:954ebfd83406f0dfed93eb5157ba841af5426aa95d4054174fff45095fd873a1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ docker image rmi 0235ed43fc7f -f
</span></span><span style="display:flex;"><span>Untagged: registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>Deleted: sha256:0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>Deleted: sha256:f05f85850cf4fac79e279d93afb6645c026de0223d07b396fce86c2f76096c1f
</span></span><span style="display:flex;"><span>Deleted: sha256:7432b0766b885144990edd3166fbabed081be71d28d186f4d525e52729f06b1f
</span></span><span style="display:flex;"><span>Deleted: sha256:2c6e3361c2ee2f43bd75fb9c7c12d981ce06df2d51a134965fa47754760efff0
</span></span><span style="display:flex;"><span>Deleted: sha256:7ad7f7245b45fbe758ebd5788e0ba268a56829715527a9a4bc51708c21af1c7f
</span></span><span style="display:flex;"><span>Deleted: sha256:3b73a621115a59564979f41552181dce07f3baa17e27428f7fff2155042a1901
</span></span><span style="display:flex;"><span>Deleted: sha256:78648c2606a7c4c76885806ed976b13e4d008940bd3d7a18b52948a6be71b60d
</span></span><span style="display:flex;"><span>Deleted: sha256:383d4a6dc5be9914878700809b4a3925379c80ab792dfe9e79d14b0c1d6b5fad
</span></span></code></pre></div><p>Then I&rsquo;ll rerun the job to show the failure:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/4Qv6C0DQfEWoWqGykW2lNU/be3d6cc478d4d86182f47bc2f8341ade/image2.png" alt="GitLab Runner without internet access fails to pull an image from internal registry cache" />
</figure>


</p>
<!-- raw HTML omitted -->
<h4 id="scp-file-to-gitlab-instance">SCP file to GitLab instance</h4>
<p>Now, from my local machine, I will SCP the file to my GitLab instance as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ gcloud compute scp secret-detection.tar INSTANCE:~ --zone<span style="color:#f92672">=</span>ZONE
</span></span><span style="display:flex;"><span>secret-detection.tar                                                          100%   81MB  21.5MB/s   00:03
</span></span></code></pre></div><h3 id="load-transferred-images-into-offline-container-registry">Load transferred images into offline container registry</h3>
<p>Next, I&rsquo;ll SSH into my VM and load the Docker image:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ gcloud compute ssh INSTANCE --zone<span style="color:#f92672">=</span>ZONE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sudo docker load -i secret-detection.tar
</span></span><span style="display:flex;"><span>c3c8e454c212: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  2.521MB/2.521MB
</span></span><span style="display:flex;"><span>51e93afaeedc: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  32.55MB/32.55MB
</span></span><span style="display:flex;"><span>e8a25e39bb30: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  221.2kB/221.2kB
</span></span><span style="display:flex;"><span>390704968493: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  225.8kB/225.8kB
</span></span><span style="display:flex;"><span>76cf57e75f63: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  17.64MB/17.64MB
</span></span><span style="display:flex;"><span>c4c7a681fd10: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  4.608kB/4.608kB
</span></span><span style="display:flex;"><span>f0690f406157: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  24.01MB/24.01MB
</span></span><span style="display:flex;"><span>Loaded image: registry.gitlab.com/security-products/secrets:6
</span></span></code></pre></div><h3 id="run-the-scanners">Run the scanners</h3>
<p>I&rsquo;ll re-run the pipeline manually and the scanner will be pulled from the cache. Once the pipeline completes, we can see the secret detection job is successful:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/2NwioKHVElZI8RWYLnpVGs/90b6a76f403eb46ff8171df844d1f47b/image7.png" alt="GitLab Runner without internet access successfully pulling from internal registry cache after image loaded" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>If you want to pull the image from a different location or you tag your images in a different way, you can edit the config as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">include</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">template</span>: <span style="color:#ae81ff">Jobs/Secret-Detection.gitlab-ci.yml</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">variables</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SECURE_ANALYZERS_PREFIX</span>: <span style="color:#e6db74">&#34;localhost:5000/analyzers&#34;</span>
</span></span></code></pre></div><p>See the offline environments documentation for more information.</p>
<h3 id="view-scanner-results">View scanner results</h3>
<p>Once the scanner completes on the default branch, a vulnerability report is populated with all the findings. The vulnerability report provides information about vulnerabilities from scans of the default branch.</p>
<p>You can access the vulnerability report by navigating to the side tab and selecting <strong>Secure &gt; Vulnerability Report</strong>:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/3Mf0eQrW7abnwowcEE1Fyq/96edfacb8008b7cf1bb74e391c218f27/vulnerability_report.png" alt="GitLab Vulnerability Report with secret detection findings" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The project’s vulnerability report provides:</p>
<ul>
<li>totals of vulnerabilities per severity level</li>
<li>filters for common vulnerability attributes</li>
<li>details of each vulnerability, presented in tabular layout</li>
<li>a timestamp showing when it was updated, including a link to the latest pipeline</li>
</ul>
<p>We can see that two vulnerabilities were detected by the Secret Detection scanner. If we click on a vulnerability, we will be transported to its vulnerability page:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/1xA76q6EapOqhyuG03eLXr/1aedd70afd87becbb099140facadbaf2/insights.png" alt="GitLab Vulnerability Page showing detailed insights" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The vulnerability page provides details of the vulnerability, which can be used to triage and find a path to remediation. These vulnerability details include:</p>
<ul>
<li>description</li>
<li>when it was detected</li>
<li>current status</li>
<li>available actions</li>
<li>linked issues</li>
<li>actions log</li>
<li>filename and line number of the vulnerability (if available)</li>
<li>severity</li>
</ul>
<h2 id="read-more">Read more</h2>
<p>To learn more about GitLab and running security scanners in air-gapped environments, check out the following resources:</p>
<ul>
<li>GitLab Ultimate</li>
<li>GitLab Security and Compliance Solutions</li>
<li>GitLab Offline Deployments Documentation</li>
<li>GitLab Application Security Documentation</li>
</ul>
<p>Air-gapped environments are computer networks or systems that are physically isolated from unsecured networks, such as the public internet or unsecured local area networks. This isolation is implemented as a security measure to protect sensitive data and critical systems from external cyber threats by providing:</p>
<ul>
<li>Enhanced security: By physically isolating systems from external networks, air-gapped environments help prevent remote attacks, malware infections, and unauthorized data access. This is crucial for highly sensitive data and critical systems.</li>
<li>Data protection: Air-gapping provides the strongest protection against data exfiltration since there&rsquo;s no direct connection that attackers could use to steal information.</li>
<li>Critical infrastructure protection: For systems that control vital infrastructure (like power plants, water treatment facilities, or military systems), air-gapping helps prevent potentially catastrophic cyber attacks.</li>
<li>Compliance requirements: Many regulatory frameworks require air-gapping for certain types of sensitive data or critical systems, particularly in government, healthcare, and financial sectors.</li>
<li>Malware protection: Without network connectivity, systems are protected from network-based malware infections and ransomware attacks.</li>
</ul>
<p>Even though air-gapped systems are isolated, they can still have vulnerabilities. Regular security scanning helps identify these weaknesses before they can be exploited. In this article, you will learn the different security scanners GitLab provides and how they can be added/updated in a limited-connectivity environment.</p>
<h2 id="gitlab-security-scanners-in-air-gapped-environments-1">GitLab security scanners in air-gapped environments</h2>
<p>GitLab provides a variety of different security scanners for the complete application lifecycle. The scanners that support air-gapped environments include:</p>
<ul>
<li>Static Application Security Testing (SAST)</li>
<li>Dynamic Application Security Testing (DAST)</li>
<li>Secret Detection</li>
<li>Container Scanning</li>
<li>Dependency Scanning</li>
<li>API Fuzzing</li>
<li>License Scanning</li>
</ul>
<p>By default, GitLab Self-Managed instances pull security scanner images from the public GitLab container registry (registry.gitlab.com) and store them within the built-in local GitLab container registry. I will demonstrate this flow below by running the following pipeline that scans for secrets on a sample project:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">include</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">template</span>: <span style="color:#ae81ff">Jobs/Secret-Detection.gitlab-ci.yml</span>
</span></span></code></pre></div><p>When running the job in an internet-connected GitLab instance the job passes:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/1xjIX1SEB9aG51s9Y71EiE/30da85dd73d7c426408bc3e38f4f6eac/pass-1.png" alt="GitLab Runner with internet access successfully pulling from external registry" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --> However, If I disable internet access to the VM running GitLab, the <code>secret-detection</code> job will fail to download the container image, causing the job to fail:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/25NWzvQA2RceTQlb2aLmzk/fa6e62e89a3835be5b9ff02a8fb245da/fail-1.png" alt="GitLab Runner without internet access failing to pull from external registry" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>Alternatively, if I set my GitLab Runners’ pull image policy to <code>if-not-present</code> from <code>always</code>, I can load the cached version of the scanner if it was run before on the internet by using the image stored in our local docker:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/48sKSLIBwq6wuqo6jLCMg6/c286af66ec43c2aefd67d3735d175c57/pass-2.png" alt="GitLab Runner without internet access successfully pulling from internal registry cache" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="setting-up-offline-scanning-prerequisites-1">Setting up offline scanning prerequisites</h3>
<p>Running these security scanners in an air-gapped environment requires the following:</p>
<ul>
<li>GitLab Ultimate subscription</li>
<li>Offline cloud license</li>
<li>GitLab Self-Managed cluster</li>
</ul>
<p>You can follow along with this tutorial in any GitLab Self-Managed EE instance (even those that are not air-gapped) to learn how to transfer and run images in an air-gapped environment. In this tutorial, I will demonstrate how to load scanner images onto a GitLab-EE instance running in a Google Compute VM where I cut off the <code>EGRESS</code> to everything by implementing firewall rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># egress firewall rule to block all outbound traffic to the internet</span>
</span></span><span style="display:flex;"><span>$ gcloud compute firewall-rules create deny-internet-egress 
</span></span><span style="display:flex;"><span>    --direction<span style="color:#f92672">=</span>EGRESS 
</span></span><span style="display:flex;"><span>    --priority<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span> 
</span></span><span style="display:flex;"><span>    --network<span style="color:#f92672">=</span>default 
</span></span><span style="display:flex;"><span>    --action<span style="color:#f92672">=</span>DENY 
</span></span><span style="display:flex;"><span>    --rules<span style="color:#f92672">=</span>all 
</span></span><span style="display:flex;"><span>    --destination-ranges<span style="color:#f92672">=</span>0.0.0.0/0 
</span></span><span style="display:flex;"><span>    --target-tags<span style="color:#f92672">=</span>no-internet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create an allow rule for internal traffic with higher priority</span>
</span></span><span style="display:flex;"><span>$ gcloud compute firewall-rules create allow-internal-egress 
</span></span><span style="display:flex;"><span>    --direction<span style="color:#f92672">=</span>EGRESS 
</span></span><span style="display:flex;"><span>    --priority<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span> 
</span></span><span style="display:flex;"><span>    --network<span style="color:#f92672">=</span>default 
</span></span><span style="display:flex;"><span>    --action<span style="color:#f92672">=</span>ALLOW 
</span></span><span style="display:flex;"><span>    --rules<span style="color:#f92672">=</span>all 
</span></span><span style="display:flex;"><span>    --destination-ranges<span style="color:#f92672">=</span>10.0.0.0/8,192.168.0.0/16,172.16.0.0/12 
</span></span><span style="display:flex;"><span>    --target-tags<span style="color:#f92672">=</span>no-internet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply tag to VM</span>
</span></span><span style="display:flex;"><span>$ gcloud compute instances add-tags YOUR_VM_NAME 
</span></span><span style="display:flex;"><span>    --zone<span style="color:#f92672">=</span>YOUR_ZONE 
</span></span><span style="display:flex;"><span>    --tags<span style="color:#f92672">=</span>no-internet
</span></span></code></pre></div><p>Then, once I SSH into my VM, you can see we cannot connect to registry.gitlab.com:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># showing I can’t access the gitlab container registry</span>
</span></span><span style="display:flex;"><span>$ ping registry.gitlab.com
</span></span><span style="display:flex;"><span>PING registry.gitlab.com <span style="color:#f92672">(</span>35.227.35.254<span style="color:#f92672">)</span> 56<span style="color:#f92672">(</span>84<span style="color:#f92672">)</span> bytes of data.
</span></span><span style="display:flex;"><span>^C
</span></span><span style="display:flex;"><span>--- registry.gitlab.com ping statistics ---
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> packets transmitted, <span style="color:#ae81ff">0</span> received, 100% packet loss, time 2031ms
</span></span></code></pre></div><p><strong>Note:</strong> I am still allowing ingress so I can copy files and SSH into the machine.</p>
<h2 id="load-security-scanners-in-air-gapped-environments-1">Load security scanners in air-gapped environments</h2>
<p>To use the various security scanners on air-gapped environments, the GitLab Runner must be able to fetch the scanner container images from GitLab’s built-in container registry. This means that the container images for the security scanners must be downloaded and packaged in a separate environment with access to the public internet. The process of loading security scanners onto an air-gapped environment includes the following:</p>
<ol>
<li>Download and package container images from the public internet.</li>
<li>Transfer images to offline environment.</li>
<li>Load transferred images into offline container registry.</li>
</ol>
<p>Now let’s go over how we can implement GitLab Secret Detection in an air-gapped environment.</p>
<h3 id="download-and-package-container-images-from-public-internet-1">Download and package container images from public internet</h3>
<p>Let’s download the container image for secret detection and store it within our local container registry. Other scanner images can be found in the offline deployments documentation. I will be using Podman desktop to download these images, but you can use Docker desktop or other alternatives.</p>
<ol>
<li>Pull the GitLab Secret Detection image.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ podman pull registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>Trying to pull registry.gitlab.com/security-products/secrets:6...
</span></span><span style="display:flex;"><span>Getting image source signatures
</span></span><span style="display:flex;"><span>Copying blob sha256:999745130ac045f2b1c29ecce088b43fc4a95bbb82b7960fb7b8abe0e3801bf8
</span></span><span style="display:flex;"><span>Copying blob sha256:a4f7c013bb259c146cd8455b7c3943df7ed84b157e42a2348eef16546d8179b1
</span></span><span style="display:flex;"><span>Copying blob sha256:1f3e46996e2966e4faa5846e56e76e3748b7315e2ded61476c24403d592134f0
</span></span><span style="display:flex;"><span>Copying blob sha256:400a41f248eb3c870bd2b07073632c49f1e164c8efad56ea3b24098a657ec625
</span></span><span style="display:flex;"><span>Copying blob sha256:9090f17a5a1bb80bcc6f393b0715210568dd0a7749286e3334a1a08fb32d34e6
</span></span><span style="display:flex;"><span>Copying blob sha256:c7569783959081164164780f6c1b0bbe1271ee8d291d3e07b2749ae741621ea3
</span></span><span style="display:flex;"><span>Copying blob sha256:20c7ca6108f808ad5905f6db4f7e3c02b21b69abdea8b45abfa34c0a2ba8bdb5
</span></span><span style="display:flex;"><span>Copying blob sha256:e8645a00be64d77c6ff301593ce34cd8c17ffb2b36252ca0f2588009a7918d2e
</span></span><span style="display:flex;"><span>Copying config sha256:0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>Writing manifest to image destination
</span></span><span style="display:flex;"><span>WARNING: image platform <span style="color:#f92672">(</span>linux/amd64<span style="color:#f92672">)</span> does not match the expected platform <span style="color:#f92672">(</span>linux/arm64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ podman images
</span></span><span style="display:flex;"><span>REPOSITORY                                                  TAG         IMAGE ID      CREATED      SIZE
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets               <span style="color:#ae81ff">6</span>           0235ed43fc7f  <span style="color:#ae81ff">4</span> hours ago  85.3 MB
</span></span></code></pre></div><ol start="2">
<li>Save the image as a tarball.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ podman save -o secret-detection.tar registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>$ chmod +r secret-detection.tar
</span></span><span style="display:flex;"><span>$ ls -al secret-detection.tar
</span></span><span style="display:flex;"><span>-rw-r--r--@ <span style="color:#ae81ff">1</span> fern  staff  <span style="color:#ae81ff">85324800</span> Jan <span style="color:#ae81ff">10</span> 10:25 secret-detection.tar
</span></span></code></pre></div><p>Alternatively, you can use the official GitLab template on an environment with internet access to download the container images needed for the security scanners and save them as job artifacts or push them to the container registry of the project where the pipeline is executed.</p>
<h3 id="transfer-images-to-offline-environment-1">Transfer images to offline environment</h3>
<p>Next, let&rsquo;s transfer the tarball to our air-gapped environment. This can be done in several ways, depending on your needs, such as:</p>
<ul>
<li>Physical media transfer</li>
<li>Data diodes</li>
<li>Guard systems</li>
<li>Cross-domain solutions (CDS)</li>
</ul>
<p>I will SCP (Secure Copy Protocol) the tarball directly to my VM that does not have egress access, but does allow ingress. As this is just for demonstration purposes, make sure to consult your organization&rsquo;s security policies and transfer procedures for air-gapped environments.</p>
<h4 id="verify-the-image-is-not-cached-1">Verify the image is not cached</h4>
<p>Before transferring the file, I’ll delete the Docker images on my GitLab instance pertaining to secret detection to make sure they aren&rsquo;t cached:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker images
</span></span><span style="display:flex;"><span>REPOSITORY                                                          TAG              IMAGE ID       CREATED        SIZE
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets                       <span style="color:#ae81ff">6</span>                0235ed43fc7f   <span style="color:#ae81ff">9</span> hours ago    84.8MB
</span></span><span style="display:flex;"><span>registry.gitlab.com/security-products/secrets                       &lt;none&gt;           16d88433af61   <span style="color:#ae81ff">17</span> hours ago   74.9MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ docker image rmi 16d88433af61 -f
</span></span><span style="display:flex;"><span>Untagged: registry.gitlab.com/security-products/secrets@sha256:f331da6631d791fcd58d3f23d868475a520f50b02d64000e2faf1def66c75d48
</span></span><span style="display:flex;"><span>Deleted: sha256:16d88433af618f0b405945031de39fe40b3e8ef1bddb91ca036de0f5b32399d7
</span></span><span style="display:flex;"><span>Deleted: sha256:1bb06f72f06810e95a70039e797481736e492201f51a03b02d27db055248ab6f
</span></span><span style="display:flex;"><span>Deleted: sha256:a5ef2325ce4be9b39993ce301f8ed7aad1c854d7ee66f26a56a96967c6606510
</span></span><span style="display:flex;"><span>Deleted: sha256:f7cdac818a36d6c023763b76a6589c0db7609ca883306af4f38b819e62f29471
</span></span><span style="display:flex;"><span>Deleted: sha256:5eabf4d47287dee9887b9692d55c8b5f848b50b3b7248f67913036014e74a0e9
</span></span><span style="display:flex;"><span>Deleted: sha256:51b7cb600604c0737356f17bc02c22bac3a63697f0bf95ba7bacb5b421fdb7da
</span></span><span style="display:flex;"><span>Deleted: sha256:1546193b011d192aa769a15d3fdd55eb4e187f201f5ff7506243abb02525dc06
</span></span><span style="display:flex;"><span>Deleted: sha256:1ea72408d0484c3059cc0008539e6f494dc829caa1a97d156795687d42d9cb57
</span></span><span style="display:flex;"><span>Deleted: sha256:1313ee9da7716d85f63cfdd1129f715e9bbb6c9c0306e4708ee73672b3e40f26
</span></span><span style="display:flex;"><span>Deleted: sha256:954ebfd83406f0dfed93eb5157ba841af5426aa95d4054174fff45095fd873a1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ docker image rmi 0235ed43fc7f -f
</span></span><span style="display:flex;"><span>Untagged: registry.gitlab.com/security-products/secrets:6
</span></span><span style="display:flex;"><span>Deleted: sha256:0235ed43fc7fb2852c76e2d6196601968ae0375c72a517bef714cd712600f894
</span></span><span style="display:flex;"><span>Deleted: sha256:f05f85850cf4fac79e279d93afb6645c026de0223d07b396fce86c2f76096c1f
</span></span><span style="display:flex;"><span>Deleted: sha256:7432b0766b885144990edd3166fbabed081be71d28d186f4d525e52729f06b1f
</span></span><span style="display:flex;"><span>Deleted: sha256:2c6e3361c2ee2f43bd75fb9c7c12d981ce06df2d51a134965fa47754760efff0
</span></span><span style="display:flex;"><span>Deleted: sha256:7ad7f7245b45fbe758ebd5788e0ba268a56829715527a9a4bc51708c21af1c7f
</span></span><span style="display:flex;"><span>Deleted: sha256:3b73a621115a59564979f41552181dce07f3baa17e27428f7fff2155042a1901
</span></span><span style="display:flex;"><span>Deleted: sha256:78648c2606a7c4c76885806ed976b13e4d008940bd3d7a18b52948a6be71b60d
</span></span><span style="display:flex;"><span>Deleted: sha256:383d4a6dc5be9914878700809b4a3925379c80ab792dfe9e79d14b0c1d6b5fad
</span></span></code></pre></div><p>Then I&rsquo;ll rerun the job to show the failure:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/4Qv6C0DQfEWoWqGykW2lNU/be3d6cc478d4d86182f47bc2f8341ade/image2.png" alt="GitLab Runner without internet access fails to pull an image from internal registry cache" />
</figure>


</p>
<!-- raw HTML omitted -->
<h4 id="scp-file-to-gitlab-instance-1">SCP file to GitLab instance</h4>
<p>Now, from my local machine, I will SCP the file to my GitLab instance as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ gcloud compute scp secret-detection.tar INSTANCE:~ --zone<span style="color:#f92672">=</span>ZONE
</span></span><span style="display:flex;"><span>secret-detection.tar                                                          100%   81MB  21.5MB/s   00:03
</span></span></code></pre></div><h3 id="load-transferred-images-into-offline-container-registry-1">Load transferred images into offline container registry</h3>
<p>Next, I&rsquo;ll SSH into my VM and load the Docker image:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ gcloud compute ssh INSTANCE --zone<span style="color:#f92672">=</span>ZONE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sudo docker load -i secret-detection.tar
</span></span><span style="display:flex;"><span>c3c8e454c212: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  2.521MB/2.521MB
</span></span><span style="display:flex;"><span>51e93afaeedc: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  32.55MB/32.55MB
</span></span><span style="display:flex;"><span>e8a25e39bb30: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  221.2kB/221.2kB
</span></span><span style="display:flex;"><span>390704968493: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  225.8kB/225.8kB
</span></span><span style="display:flex;"><span>76cf57e75f63: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  17.64MB/17.64MB
</span></span><span style="display:flex;"><span>c4c7a681fd10: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  4.608kB/4.608kB
</span></span><span style="display:flex;"><span>f0690f406157: Loading layer <span style="color:#f92672">[==================================================</span>&gt;<span style="color:#f92672">]</span>  24.01MB/24.01MB
</span></span><span style="display:flex;"><span>Loaded image: registry.gitlab.com/security-products/secrets:6
</span></span></code></pre></div><h3 id="run-the-scanners-1">Run the scanners</h3>
<p>I&rsquo;ll re-run the pipeline manually and the scanner will be pulled from the cache. Once the pipeline completes, we can see the secret detection job is successful:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/2NwioKHVElZI8RWYLnpVGs/90b6a76f403eb46ff8171df844d1f47b/image7.png" alt="GitLab Runner without internet access successfully pulling from internal registry cache after image loaded" />
</figure>


</p>
<!-- raw HTML omitted -->
<p>If you want to pull the image from a different location or you tag your images in a different way, you can edit the config as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">include</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">template</span>: <span style="color:#ae81ff">Jobs/Secret-Detection.gitlab-ci.yml</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">variables</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SECURE_ANALYZERS_PREFIX</span>: <span style="color:#e6db74">&#34;localhost:5000/analyzers&#34;</span>
</span></span></code></pre></div><p>See the offline environments documentation for more information.</p>
<h3 id="view-scanner-results-1">View scanner results</h3>
<p>Once the scanner completes on the default branch, a vulnerability report is populated with all the findings. The vulnerability report provides information about vulnerabilities from scans of the default branch.</p>
<p>You can access the vulnerability report by navigating to the side tab and selecting <strong>Secure &gt; Vulnerability Report</strong>:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/3Mf0eQrW7abnwowcEE1Fyq/96edfacb8008b7cf1bb74e391c218f27/vulnerability_report.png" alt="GitLab Vulnerability Report with secret detection findings" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The project’s vulnerability report provides:</p>
<ul>
<li>totals of vulnerabilities per severity level</li>
<li>filters for common vulnerability attributes</li>
<li>details of each vulnerability, presented in tabular layout</li>
<li>a timestamp showing when it was updated, including a link to the latest pipeline</li>
</ul>
<p>We can see that two vulnerabilities were detected by the Secret Detection scanner. If we click on a vulnerability, we will be transported to its vulnerability page:</p>
<p>
<figure>
  <img src="https://images.ctfassets.net/r9o86ar0p03f/1xA76q6EapOqhyuG03eLXr/1aedd70afd87becbb099140facadbaf2/insights.png" alt="GitLab Vulnerability Page showing detailed insights" />
</figure>


</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The vulnerability page provides details of the vulnerability, which can be used to triage and find a path to remediation. These vulnerability details include:</p>
<ul>
<li>description</li>
<li>when it was detected</li>
<li>current status</li>
<li>available actions</li>
<li>linked issues</li>
<li>actions log</li>
<li>filename and line number of the vulnerability (if available)</li>
<li>severity</li>
</ul>
<h2 id="read-more-1">Read more</h2>
<p>To learn more about GitLab and running security scanners in air-gapped environments, check out the following resources:</p>
<ul>
<li>GitLab Ultimate</li>
<li>GitLab Security and Compliance Solutions</li>
<li>GitLab Offline Deployments Documentation</li>
<li>GitLab Application Security Documentation</li>
</ul>
<p>Go to Source</p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2025-03-21-cve-2025-30345---openslides-cross-site-/">CVE-2025-30345 - OpenSlides Cross-Site Scripting XSS</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-30342---openslides-cross-site-/">CVE-2025-30342 - OpenSlides Cross-Site Scripting XSS</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-30343---openslides-directory-t/">CVE-2025-30343 - OpenSlides Directory Traversal Vulnerability</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2025-30344---openslides-timing-base/">CVE-2025-30344 - OpenSlides Timing-Based Authentication Bypass</a></li>
				
				<li><a href="/posts/2025-03-21-cve-2024-50053---zohocorp-manageengine-/">CVE-2024-50053 - Zohocorp ManageEngine ServiceDesk Plus Stored Cross-Site Scripting</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2025 <a href="https://ghariib.ir/"><b>Alireza Gharib. All right reserved</b></a>.
	<a href="https://github.com/Gharib110"><b>Github</b></a>.
	</p>
</footer>

</body>
</html>
